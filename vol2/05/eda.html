
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>メディア展開データの基礎分析 &#8212; データ可視化技術入門</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'vol2/05/eda';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="icon" href="../../_static/pen.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="【練習問題】" href="practice_q.html" />
    <link rel="prev" title="メディア展開データの前処理" href="mix_preprocess.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">データ可視化技術入門</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">上巻</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../vol1/03/index.html">3章 マンガデータ分析①</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/03/cm_preprocess.html">マンガデータの前処理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/03/eda.html">マンガデータの基礎分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/03/practice_q.html">【練習問題】</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/03/practice_a.html">【解答例】</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../vol1/04/index.html">4章 マンガデータ分析②</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/04/amounts.html">マンガデータの量を見る</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/04/dists.html">マンガデータの分布を見る</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/04/props.html">マンガデータの内訳を見る</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/04/assocs.html">マンガデータの関係を見る</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/04/practice_q.html">【練習問題】</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/04/practice_a.html">【解答例】</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../vol1/05/index.html">5章 Python/Pandas/Plotly</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/05/python.html">Pythonの基本</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/05/pandas.html">Pandasの基本</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/05/plotly.html">Plotlyの基本</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/05/practice_q.html">【練習問題】</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/05/practice_a.html">【解答例】</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../vol1/06/index.html">6章 取得/前処理/基礎分析</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/06/an_preprocess.html">アニメデータの前処理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/06/an_eda.html">アニメデータの基礎分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/06/gm_preprocess.html">ゲームデータの前処理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/06/gm_eda.html">ゲームデータの基礎分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/06/practice_q.html">【練習問題】</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vol1/06/practice_a.html">【解答例】</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">下巻</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../01/index.html">1章 量を見る手法</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../01/bar.html">棒グラフ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/gbar.html">集合棒グラフ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/sbar.html">積上げ棒グラフ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/heatmap.html">ヒートマップ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/practice_q.html">【練習問題】</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/practice_a.html">【解答例】</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../02/index.html">2章 分布を見る手法</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../02/hist.html">ヒストグラム</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/density.html">密度プロット</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/box.html">箱ひげ図</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/violin.html">バイオリンプロット</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/ridge.html">リッジラインプロット</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/practice_q.html">【練習問題】</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/practice_a.html">【解答例】</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../03/index.html">3章 内訳を見る手法</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../03/pie.html">円グラフ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/bar.html">棒グラフ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/mosaic.html">モザイクプロット</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/area.html">積上げ密度プロット</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/tree.html">ツリーマップ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/parallel.html">パラレルセットグラフ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/practice_q.html">【練習問題】</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/practice_a.html">【解答例】</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04/index.html">4章 関係を見る手法</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../04/scatter.html">散布図</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/bubble.html">バブルチャート</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/matrix.html">散布図行列</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/2d.html">二次元ヒストグラム</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/contour.html">等値線図</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/line.html">折れ線グラフ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/connected.html">連結散布図</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/practice_q.html">【練習問題】</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/practice_a.html">【解答例】</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">5章 メディア展開データ分析①</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mix_preprocess.html">メディア展開データの前処理</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">メディア展開データの基礎分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="practice_q.html">【練習問題】</a></li>
<li class="toctree-l2"><a class="reference internal" href="practice_a.html">【解答例】</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../06/index.html">6章 メディア展開データ分析②</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../06/amounts.html">メディア展開データの量を見る</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/dists.html">メディア展開データの分布を見る</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/props.html">メディア展開データの内訳を見る</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/assocs.html">メディア展開データの関係を見る</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/practice_q.html">【練習問題】</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/practice_a.html">【解答例】</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../appendix/setup.html">本書の再現と発展</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/references.html">参考文献</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kakeami/vizbook-jupyter" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kakeami/vizbook-jupyter/issues/new?title=Issue%20on%20page%20%2Fvol2/05/eda.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/vol2/05/eda.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>メディア展開データの基礎分析</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">準備</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import">Import</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">変数</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">関数</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mix-ae-crt-csv"><code class="docutils literal notranslate"><span class="pre">mix_ae_crt.csv</span></code>の基礎分析</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">全体像の把握</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#date"><code class="docutils literal notranslate"><span class="pre">date</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aeidaenameaeno"><code class="docutils literal notranslate"><span class="pre">aeid</span></code>、<code class="docutils literal notranslate"><span class="pre">aename</span></code>、<code class="docutils literal notranslate"><span class="pre">aeno</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acidacname"><code class="docutils literal notranslate"><span class="pre">acid</span></code>、<code class="docutils literal notranslate"><span class="pre">acname</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#asid"><code class="docutils literal notranslate"><span class="pre">asid</span></code>列の深堀り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#n-ae"><code class="docutils literal notranslate"><span class="pre">n_ae</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#first-datelast-date"><code class="docutils literal notranslate"><span class="pre">first_date</span></code>、<code class="docutils literal notranslate"><span class="pre">last_date</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ccidccname"><code class="docutils literal notranslate"><span class="pre">ccid</span></code>、<code class="docutils literal notranslate"><span class="pre">ccname</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mcname"><code class="docutils literal notranslate"><span class="pre">mcname</span></code>列の深堀り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#crtidcrtname"><code class="docutils literal notranslate"><span class="pre">crtid</span></code>、<code class="docutils literal notranslate"><span class="pre">crtname</span></code>列の深掘り</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mix-ce-ac-csv"><code class="docutils literal notranslate"><span class="pre">mix_ce_ac.csv</span></code>の基礎分析</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">全体像の把握</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><code class="docutils literal notranslate"><span class="pre">date</span></code>列の深堀り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ceidcename"><code class="docutils literal notranslate"><span class="pre">ceid</span></code>、<code class="docutils literal notranslate"><span class="pre">cename</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><code class="docutils literal notranslate"><span class="pre">ccid</span></code>、<code class="docutils literal notranslate"><span class="pre">ccname</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#miid"><code class="docutils literal notranslate"><span class="pre">miid</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#page-startpage-endpagespage-start-position"><code class="docutils literal notranslate"><span class="pre">page_start</span></code>、<code class="docutils literal notranslate"><span class="pre">page_end</span></code>、<code class="docutils literal notranslate"><span class="pre">pages</span></code>、<code class="docutils literal notranslate"><span class="pre">page_start_position</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-coloredfour-colored"><code class="docutils literal notranslate"><span class="pre">two_colored</span></code>、<code class="docutils literal notranslate"><span class="pre">four_colored</span></code>列の深堀り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#n-ce"><code class="docutils literal notranslate"><span class="pre">n_ce</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#n-2cn-4c"><code class="docutils literal notranslate"><span class="pre">n_2c</span></code>、<code class="docutils literal notranslate"><span class="pre">n_4c</span></code>列の深堀り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#first-date-cclast-date-cc"><code class="docutils literal notranslate"><span class="pre">first_date_cc</span></code>、<code class="docutils literal notranslate"><span class="pre">last_date_cc</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mcidmcname"><code class="docutils literal notranslate"><span class="pre">mcid</span></code>、<code class="docutils literal notranslate"><span class="pre">mcname</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><code class="docutils literal notranslate"><span class="pre">acid</span></code>、<code class="docutils literal notranslate"><span class="pre">acname</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><code class="docutils literal notranslate"><span class="pre">asid</span></code>列の深堀り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><code class="docutils literal notranslate"><span class="pre">n_ae</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#first-date-aclast-date-ac"><code class="docutils literal notranslate"><span class="pre">first_date_ac</span></code>、<code class="docutils literal notranslate"><span class="pre">last_date_ac</span></code>列の深掘り</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>メディア展開データの基礎分析<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<section id="id2">
<h2>準備<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<section id="import">
<h3>Import<a class="headerlink" href="#import" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># warningsモジュールのインポート</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="c1"># データ解析や機械学習のライブラリ使用時の警告を非表示にする目的で警告を無視</span>
<span class="c1"># 本書の文脈では、可視化の学習に議論を集中させるために選択した</span>
<span class="c1"># ただし、学習以外の場面で、警告を無視する設定は推奨しない</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># difflibモジュールのインポート</span>
<span class="c1"># 文字列間の類似度や差異を計算するためのユーティリティを提供</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">difflib</span>

<span class="c1"># pathlibモジュールのインポート</span>
<span class="c1"># ファイルシステムのパスを扱う</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># typingモジュールからの型ヒント関連のインポート</span>
<span class="c1"># 関数やクラスの引数・返り値の型を注釈するためのツール</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>

<span class="c1"># numpy：数値計算ライブラリのインポート</span>
<span class="c1"># npという名前で参照可能</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># pandas：データ解析ライブラリのインポート</span>
<span class="c1"># pdという名前で参照可能</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># tqdm_notebookのインポート</span>
<span class="c1"># Jupyter Notebook環境でのプログレスバー表示に使用</span>
<span class="c1"># tqdmという名前で参照可能</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm_notebook</span> <span class="k">as</span> <span class="n">tqdm</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="id3">
<h3>変数<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 読み込み対象ディレクトリの定義</span>

<span class="c1"># メディア展開データが保存されているディレクトリのパス</span>
<span class="n">DIR_IN</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;../../../data/mix/input&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 読み込み対象ファイル名の定義</span>

<span class="c1"># アニメ各話と原作マンガの作者者の対応関係に関するファイル</span>
<span class="n">FN_AE_CRT</span> <span class="o">=</span> <span class="s2">&quot;mix_ae_crt.csv&quot;</span>

<span class="c1"># マンガ各話とアニメ作品の対応関係に関するファイル</span>
<span class="n">FN_CE_AC</span> <span class="o">=</span> <span class="s2">&quot;mix_ce_ac.csv&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="id4">
<h3>関数<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">find_closest_match</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DataFrameの行に対して、指定されたアニメ作品名(`acname`)に最も近いマンガ作品名(`ccname`)を見つける</span>
<span class="sd">    ただし、`acname`がNaNの行は処理をスキップする</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    row : pd.Series</span>
<span class="sd">        処理するDataFrameの行。各行はアニメ作品名(`acname`)を含む</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        検索対象のマンガ作品名(`ccname`)を含むDataFrame</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Optional[str]</span>
<span class="sd">        最も類似度が高いマンガ作品名</span>
<span class="sd">        ただし、`acname`がNaNの場合はNoneを返す</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># acnameがNaNの場合は処理をスキップ</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;acname&quot;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># acnameに最も近いccnameを返す</span>
    <span class="n">closest_matches</span> <span class="o">=</span> <span class="n">difflib</span><span class="o">.</span><span class="n">get_close_matches</span><span class="p">(</span>
        <span class="n">row</span><span class="p">[</span><span class="s2">&quot;acname&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ccname&quot;</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">closest_matches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">closest_matches</span> <span class="k">else</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="mix-ae-crt-csv">
<h2><code class="docutils literal notranslate"><span class="pre">mix_ae_crt.csv</span></code>の基礎分析<a class="headerlink" href="#mix-ae-crt-csv" title="Link to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pandasのread_csv関数でCSVファイルの読み込み</span>
<span class="n">df_ae_crt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DIR_IN</span> <span class="o">/</span> <span class="n">FN_AE_CRT</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="id5">
<h3>全体像の把握<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ae_crtデータフレームの先頭5行をTで転置して表示</span>
<span class="c1"># 列が一定以上あるとき、転置すると見やすくなることがある</span>
<span class="n">df_ae_crt</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>aeid</th>
      <td>M53249</td>
      <td>M53250</td>
      <td>M53251</td>
      <td>M53252</td>
      <td>M53253</td>
    </tr>
    <tr>
      <th>aename</th>
      <td>共 振 バイブレーション</td>
      <td>発 動 トランス</td>
      <td>悪 夢 ナイトメア</td>
      <td>迎 撃 インターセプト</td>
      <td>反 撃 カウンターアタック</td>
    </tr>
    <tr>
      <th>date</th>
      <td>2001-04-08</td>
      <td>2001-04-15</td>
      <td>2001-04-22</td>
      <td>2001-04-29</td>
      <td>2001-05-06</td>
    </tr>
    <tr>
      <th>aeno</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>acid</th>
      <td>C10003</td>
      <td>C10003</td>
      <td>C10003</td>
      <td>C10003</td>
      <td>C10003</td>
    </tr>
    <tr>
      <th>acname</th>
      <td>PROJECT ARMS</td>
      <td>PROJECT ARMS</td>
      <td>PROJECT ARMS</td>
      <td>PROJECT ARMS</td>
      <td>PROJECT ARMS</td>
    </tr>
    <tr>
      <th>asid</th>
      <td>C2484</td>
      <td>C2484</td>
      <td>C2484</td>
      <td>C2484</td>
      <td>C2484</td>
    </tr>
    <tr>
      <th>n_ae</th>
      <td>26</td>
      <td>26</td>
      <td>26</td>
      <td>26</td>
      <td>26</td>
    </tr>
    <tr>
      <th>first_date</th>
      <td>2001-04-08</td>
      <td>2001-04-08</td>
      <td>2001-04-08</td>
      <td>2001-04-08</td>
      <td>2001-04-08</td>
    </tr>
    <tr>
      <th>last_date</th>
      <td>2001-09-30</td>
      <td>2001-09-30</td>
      <td>2001-09-30</td>
      <td>2001-09-30</td>
      <td>2001-09-30</td>
    </tr>
    <tr>
      <th>ccid</th>
      <td>C92062</td>
      <td>C92062</td>
      <td>C92062</td>
      <td>C92062</td>
      <td>C92062</td>
    </tr>
    <tr>
      <th>crtid</th>
      <td>CCRT02576</td>
      <td>CCRT02576</td>
      <td>CCRT02576</td>
      <td>CCRT02576</td>
      <td>CCRT02576</td>
    </tr>
    <tr>
      <th>ccname</th>
      <td>ARMS</td>
      <td>ARMS</td>
      <td>ARMS</td>
      <td>ARMS</td>
      <td>ARMS</td>
    </tr>
    <tr>
      <th>mcname</th>
      <td>週刊少年サンデー</td>
      <td>週刊少年サンデー</td>
      <td>週刊少年サンデー</td>
      <td>週刊少年サンデー</td>
      <td>週刊少年サンデー</td>
    </tr>
    <tr>
      <th>crtname</th>
      <td>皆川亮二</td>
      <td>皆川亮二</td>
      <td>皆川亮二</td>
      <td>皆川亮二</td>
      <td>皆川亮二</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ae_crtデータフレームの形状（行数・列数）を取得</span>
<span class="c1"># shape属性を使用すると、(行数, 列数)の形で結果が返される</span>
<span class="n">df_ae_crt</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(12700, 15)
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ae_crtデータフレーム内の欠損値（NaN）の情報を集計</span>
<span class="c1"># isna()メソッドを使用して欠損値の場所をTrueとして特定</span>
<span class="c1"># その後、agg()メソッドを使用して、各列における欠損値の合計と平均を計算しTで転置</span>
<span class="n">df_ae_crt</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="nb">sum</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sum</th>
      <th>mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>aeid</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>aename</th>
      <td>26.0</td>
      <td>0.002047</td>
    </tr>
    <tr>
      <th>date</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>aeno</th>
      <td>104.0</td>
      <td>0.008189</td>
    </tr>
    <tr>
      <th>acid</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>acname</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>asid</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>n_ae</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>first_date</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>last_date</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>ccid</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>crtid</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>ccname</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>mcname</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>crtname</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ae_crtデータフレームの記述統計情報を取得</span>
<span class="c1"># describe()メソッドを使用して、各列の基本的な統計量を表示</span>
<span class="n">df_ae_crt</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n_ae</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>12700.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>184.338110</td>
    </tr>
    <tr>
      <th>std</th>
      <td>236.538762</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>30.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>75.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>198.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>783.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ae_crtデータフレームの各列に対してユニークな値の数をカウント</span>
<span class="c1"># nunique()メソッドを使用して、各列のユニークな値の数を計算</span>
<span class="c1"># その後、結果を新しいデータフレームとして整形し、列名を`nunique`とする</span>
<span class="n">df_ae_crt</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;nunique&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>nunique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>aeid</td>
      <td>11407</td>
    </tr>
    <tr>
      <th>1</th>
      <td>aename</td>
      <td>11315</td>
    </tr>
    <tr>
      <th>2</th>
      <td>date</td>
      <td>5926</td>
    </tr>
    <tr>
      <th>3</th>
      <td>aeno</td>
      <td>1076</td>
    </tr>
    <tr>
      <th>4</th>
      <td>acid</td>
      <td>238</td>
    </tr>
    <tr>
      <th>5</th>
      <td>acname</td>
      <td>238</td>
    </tr>
    <tr>
      <th>6</th>
      <td>asid</td>
      <td>152</td>
    </tr>
    <tr>
      <th>7</th>
      <td>n_ae</td>
      <td>75</td>
    </tr>
    <tr>
      <th>8</th>
      <td>first_date</td>
      <td>214</td>
    </tr>
    <tr>
      <th>9</th>
      <td>last_date</td>
      <td>216</td>
    </tr>
    <tr>
      <th>10</th>
      <td>ccid</td>
      <td>157</td>
    </tr>
    <tr>
      <th>11</th>
      <td>crtid</td>
      <td>154</td>
    </tr>
    <tr>
      <th>12</th>
      <td>ccname</td>
      <td>157</td>
    </tr>
    <tr>
      <th>13</th>
      <td>mcname</td>
      <td>4</td>
    </tr>
    <tr>
      <th>14</th>
      <td>crtname</td>
      <td>154</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># `aeid`と`crtid`の組み合わせで重複する行がないことを確認</span>
<span class="k">assert</span> <span class="n">df_ae_crt</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;aeid&quot;</span><span class="p">,</span> <span class="s2">&quot;crtid&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="date">
<h3><code class="docutils literal notranslate"><span class="pre">date</span></code>列の深掘り<a class="headerlink" href="#date" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ae_crtデータフレームの`date`列から最も古い日付と最も新しい日付を取得</span>
<span class="c1"># min()メソッドを使用して、最も古い日付を抽出</span>
<span class="c1"># max()メソッドを使用して、最も新しい日付を抽出</span>
<span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;1990-01-14&#39;, &#39;2017-09-30&#39;)
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># `date`列を日付型に変換</span>
<span class="c1"># pd.to_datetime()メソッドを使用して、文字列型の日付を日付型(datetime)に変換</span>
<span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">])</span>

<span class="c1"># 年に関する情報を新しい`year`列として追加</span>
<span class="c1"># dt.yearを使用して、日付から年のみを取得</span>
<span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>

<span class="c1"># 月に関する情報を新しい`month`列として追加</span>
<span class="c1"># dt.monthを使用して、日付から月のみを取得</span>
<span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>

<span class="c1"># 曜日に関する情報を新しい`weekday`列として追加</span>
<span class="c1"># dt.weekdayを使用して、日付から曜日の情報を数値(0:月曜日, 6:日曜日)として取得</span>
<span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;weekday&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekday</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># `year`（年）ごとに各カラムのユニークな値の数を集計</span>
<span class="c1"># 具体的には、groupbyメソッドで`year`を基準にグループ化し、</span>
<span class="c1"># nuniqueメソッドを使用して各カラムのユニークな値の数を計算</span>
<span class="c1"># その後、reset_indexメソッドでインデックスをリセットし、データフレームとして結果を返す</span>
<span class="n">df_ae_crt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)[[</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;asid&quot;</span><span class="p">,</span> <span class="s2">&quot;acid&quot;</span><span class="p">,</span> <span class="s2">&quot;aeid&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>asid</th>
      <th>acid</th>
      <th>aeid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1990</td>
      <td>5</td>
      <td>3</td>
      <td>3</td>
      <td>41</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1991</td>
      <td>12</td>
      <td>6</td>
      <td>6</td>
      <td>158</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992</td>
      <td>12</td>
      <td>4</td>
      <td>4</td>
      <td>102</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1993</td>
      <td>12</td>
      <td>6</td>
      <td>6</td>
      <td>153</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1994</td>
      <td>12</td>
      <td>9</td>
      <td>9</td>
      <td>257</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1995</td>
      <td>12</td>
      <td>5</td>
      <td>5</td>
      <td>143</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1996</td>
      <td>12</td>
      <td>6</td>
      <td>6</td>
      <td>136</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1997</td>
      <td>12</td>
      <td>8</td>
      <td>8</td>
      <td>186</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1998</td>
      <td>12</td>
      <td>11</td>
      <td>11</td>
      <td>316</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1999</td>
      <td>12</td>
      <td>12</td>
      <td>12</td>
      <td>223</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2000</td>
      <td>12</td>
      <td>15</td>
      <td>15</td>
      <td>410</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2001</td>
      <td>12</td>
      <td>19</td>
      <td>21</td>
      <td>528</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2002</td>
      <td>12</td>
      <td>20</td>
      <td>20</td>
      <td>622</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2003</td>
      <td>12</td>
      <td>17</td>
      <td>17</td>
      <td>521</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2004</td>
      <td>12</td>
      <td>21</td>
      <td>22</td>
      <td>565</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2005</td>
      <td>12</td>
      <td>23</td>
      <td>24</td>
      <td>650</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2006</td>
      <td>12</td>
      <td>28</td>
      <td>31</td>
      <td>672</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2007</td>
      <td>12</td>
      <td>23</td>
      <td>26</td>
      <td>652</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2008</td>
      <td>12</td>
      <td>18</td>
      <td>19</td>
      <td>481</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2009</td>
      <td>12</td>
      <td>17</td>
      <td>17</td>
      <td>542</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2010</td>
      <td>12</td>
      <td>20</td>
      <td>21</td>
      <td>510</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2011</td>
      <td>12</td>
      <td>19</td>
      <td>21</td>
      <td>550</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2012</td>
      <td>12</td>
      <td>18</td>
      <td>21</td>
      <td>537</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2013</td>
      <td>12</td>
      <td>21</td>
      <td>22</td>
      <td>462</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2014</td>
      <td>12</td>
      <td>22</td>
      <td>24</td>
      <td>611</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2015</td>
      <td>12</td>
      <td>23</td>
      <td>26</td>
      <td>697</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2016</td>
      <td>12</td>
      <td>23</td>
      <td>24</td>
      <td>509</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2017</td>
      <td>9</td>
      <td>7</td>
      <td>7</td>
      <td>173</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># `weekday`（曜日）ごとに各カラムのユニークな値の数を集計</span>
<span class="c1"># 具体的には、groupbyメソッドで`weekday`を基準にグループ化し、</span>
<span class="c1"># nuniqueメソッドを使用して各カラムのユニークな値の数を計算</span>
<span class="c1"># その後、reset_indexメソッドでインデックスをリセットし、データフレームとして結果を返す</span>
<span class="n">df_ae_crt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;weekday&quot;</span><span class="p">)[[</span><span class="s2">&quot;asid&quot;</span><span class="p">,</span> <span class="s2">&quot;acid&quot;</span><span class="p">,</span> <span class="s2">&quot;aeid&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>weekday</th>
      <th>asid</th>
      <th>acid</th>
      <th>aeid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>26</td>
      <td>32</td>
      <td>1289</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>37</td>
      <td>45</td>
      <td>1323</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>35</td>
      <td>39</td>
      <td>1581</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>26</td>
      <td>30</td>
      <td>1213</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>29</td>
      <td>33</td>
      <td>446</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>49</td>
      <td>68</td>
      <td>2510</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>53</td>
      <td>72</td>
      <td>3045</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="aeidaenameaeno">
<h3><code class="docutils literal notranslate"><span class="pre">aeid</span></code>、<code class="docutils literal notranslate"><span class="pre">aename</span></code>、<code class="docutils literal notranslate"><span class="pre">aeno</span></code>列の深掘り<a class="headerlink" href="#aeidaenameaeno" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 原作マンガの属するマンガ雑誌ごとに、アニメ各話数を集計</span>
<span class="n">df_ae_crt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;mcname&quot;</span><span class="p">)[</span><span class="s2">&quot;aeid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;n_ae&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>n_ae</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>週刊少年サンデー</td>
      <td>2655</td>
    </tr>
    <tr>
      <th>1</th>
      <td>週刊少年ジャンプ</td>
      <td>6393</td>
    </tr>
    <tr>
      <th>2</th>
      <td>週刊少年チャンピオン</td>
      <td>433</td>
    </tr>
    <tr>
      <th>3</th>
      <td>週刊少年マガジン</td>
      <td>1926</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># atsname（Anime Time Slot NAME)としてacidとdateを結合した文字列を追加</span>
<span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;atsname&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;acid&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="c1"># mcnameごとにユニークなアニメ放送枠数を集計</span>
<span class="n">df_ae_crt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;mcname&quot;</span><span class="p">)[</span><span class="s2">&quot;atsname&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;n_ats&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>n_ats</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>週刊少年サンデー</td>
      <td>2580</td>
    </tr>
    <tr>
      <th>1</th>
      <td>週刊少年ジャンプ</td>
      <td>6188</td>
    </tr>
    <tr>
      <th>2</th>
      <td>週刊少年チャンピオン</td>
      <td>417</td>
    </tr>
    <tr>
      <th>3</th>
      <td>週刊少年マガジン</td>
      <td>1838</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># aename列の文字列の長さを算出し、l_aename列として格納</span>
<span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;l_aename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;aename&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># l_aename列の統計量を算出</span>
<span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;l_aename&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>l_aename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>count</td>
      <td>12674.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mean</td>
      <td>14.680054</td>
    </tr>
    <tr>
      <th>2</th>
      <td>std</td>
      <td>9.101988</td>
    </tr>
    <tr>
      <th>3</th>
      <td>min</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25%</td>
      <td>9.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>50%</td>
      <td>13.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>75%</td>
      <td>18.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max</td>
      <td>200.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># l_aenameで降順ソートし、特定の列のみ抽出して冒頭5レコードを表示</span>
<span class="n">df_ae_crt</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;l_aename&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span>
    <span class="p">[</span><span class="s2">&quot;acname&quot;</span><span class="p">,</span> <span class="s2">&quot;aename&quot;</span><span class="p">,</span> <span class="s2">&quot;l_aename&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acname</th>
      <th>aename</th>
      <th>l_aename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2170</th>
      <td>School Rumble</td>
      <td>[突然の「さよなら」…迷い 込んだラビリンス…あなたはだれ? …教えて。「すれちがい」「片想...</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>4762</th>
      <td>銀魂</td>
      <td>仕事のグチは家でこぼさず外でこぼせ!って言うからちょっとこぼさせてもらうけどね「侍の国」僕ら...</td>
      <td>183.0</td>
    </tr>
    <tr>
      <th>3926</th>
      <td>【俗・】さよなら絶望先生</td>
      <td>絶望ファイト絶望の大逆転戦法!（3/2）一人より女夫の方がええいうことでっしゃろ（3/2）絶...</td>
      <td>130.0</td>
    </tr>
    <tr>
      <th>6434</th>
      <td>バクマン。[第3期]</td>
      <td>デラマン。[第1回]（9/23）　メモリーズ #1　“最高と秋人”（9/23）　メモリーズ ...</td>
      <td>129.0</td>
    </tr>
    <tr>
      <th>6433</th>
      <td>バクマン。[第3期]</td>
      <td>デラマン。[第1回]（9/23）　メモリーズ #1　“最高と秋人”（9/23）　メモリーズ ...</td>
      <td>129.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ae_crtデータフレームを&quot;acid&quot;と&quot;acname&quot;のカラムでグループ化し、</span>
<span class="c1"># 各グループの&quot;l_aename&quot;カラムに対する基本統計を計算してDataFrameに変換</span>
<span class="n">df_tmp</span> <span class="o">=</span> <span class="n">df_ae_crt</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;acid&quot;</span><span class="p">,</span> <span class="s2">&quot;acname&quot;</span><span class="p">])[</span><span class="s2">&quot;l_aename&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># 得られた統計要約df_tmpを&quot;mean&quot;カラム（平均値）に基づいて降順にソートし上位5行を表示</span>
<span class="n">df_tmp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acid</th>
      <th>acname</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>106</th>
      <td>C13492</td>
      <td>もっと ToLOVEる</td>
      <td>24.0</td>
      <td>71.000000</td>
      <td>3.867366</td>
      <td>66.0</td>
      <td>67.75</td>
      <td>71.0</td>
      <td>74.0</td>
      <td>79.0</td>
    </tr>
    <tr>
      <th>73</th>
      <td>C12181</td>
      <td>生徒会 役員共</td>
      <td>13.0</td>
      <td>62.076923</td>
      <td>17.303475</td>
      <td>14.0</td>
      <td>58.00</td>
      <td>70.0</td>
      <td>72.0</td>
      <td>76.0</td>
    </tr>
    <tr>
      <th>143</th>
      <td>C14951</td>
      <td>生徒会 役員共＊</td>
      <td>14.0</td>
      <td>48.928571</td>
      <td>10.608156</td>
      <td>29.0</td>
      <td>43.75</td>
      <td>48.0</td>
      <td>54.0</td>
      <td>69.0</td>
    </tr>
    <tr>
      <th>57</th>
      <td>C11615</td>
      <td>【俗・】さよなら絶望先生</td>
      <td>13.0</td>
      <td>45.230769</td>
      <td>26.739963</td>
      <td>24.0</td>
      <td>34.00</td>
      <td>39.0</td>
      <td>41.0</td>
      <td>130.0</td>
    </tr>
    <tr>
      <th>118</th>
      <td>C13840</td>
      <td>侵略!?　イカ娘　The Invader　comes from the　bottom of ...</td>
      <td>12.0</td>
      <td>43.083333</td>
      <td>2.998737</td>
      <td>37.0</td>
      <td>41.75</td>
      <td>43.5</td>
      <td>45.0</td>
      <td>48.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ae_crtから&quot;acname&quot;が&quot;もっと ToLOVEる&quot;に一致する行をフィルタリング</span>
<span class="c1"># その結果から&quot;aename&quot;カラムを選択し、最初の要素を取得</span>
<span class="n">df_ae_crt</span><span class="p">[</span><span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;acname&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;もっと ToLOVEる&quot;</span><span class="p">][</span><span class="s2">&quot;aename&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;もっとトラブル01\u3000もう一度ここから（10/6）\u3000もっとトラブル02\u3000お風呂場戦争（10/6）\u3000もっとトラブル03\u3000チクタク チクタク 恋の音▽*&#39;
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="acidacname">
<h3><code class="docutils literal notranslate"><span class="pre">acid</span></code>、<code class="docutils literal notranslate"><span class="pre">acname</span></code>列の深掘り<a class="headerlink" href="#acidacname" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mcnameごとのユニークなacid数を集計し、n_ac列に結果を格納して表示</span>
<span class="n">df_ae_crt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;mcname&quot;</span><span class="p">)[</span><span class="s2">&quot;acid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;n_ac&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>n_ac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>週刊少年サンデー</td>
      <td>56</td>
    </tr>
    <tr>
      <th>1</th>
      <td>週刊少年ジャンプ</td>
      <td>104</td>
    </tr>
    <tr>
      <th>2</th>
      <td>週刊少年チャンピオン</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>週刊少年マガジン</td>
      <td>58</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;mcname&#39;（マンガ雑誌名）と&#39;acid&#39;（アニメ作品ID）でグループ化し、</span>
<span class="c1"># 各グループ内でユニークな&#39;atsname&#39;（放送枠名）の数を集計</span>
<span class="n">df_tmp</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_ae_crt</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;mcname&quot;</span><span class="p">,</span> <span class="s2">&quot;acid&quot;</span><span class="p">])[</span><span class="s2">&quot;atsname&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;n_ats&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># 上記で集計したデータを&#39;mcname&#39;（マンガ雑誌名）でさらにグループ化し、</span>
<span class="c1"># 各マンガ雑誌名ごとに放送枠の数（&#39;n_ats&#39;）の要約統計量を計算</span>
<span class="n">df_tmp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;mcname&quot;</span><span class="p">)[</span><span class="s2">&quot;n_ats&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>週刊少年サンデー</td>
      <td>56.0</td>
      <td>46.071429</td>
      <td>97.280823</td>
      <td>1.0</td>
      <td>13.0</td>
      <td>26.0</td>
      <td>46.25</td>
      <td>727.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>週刊少年ジャンプ</td>
      <td>104.0</td>
      <td>59.500000</td>
      <td>98.698718</td>
      <td>1.0</td>
      <td>13.0</td>
      <td>26.0</td>
      <td>61.00</td>
      <td>759.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>週刊少年チャンピオン</td>
      <td>20.0</td>
      <td>20.850000</td>
      <td>12.832012</td>
      <td>1.0</td>
      <td>12.0</td>
      <td>20.5</td>
      <td>25.25</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>週刊少年マガジン</td>
      <td>58.0</td>
      <td>31.689655</td>
      <td>31.557915</td>
      <td>1.0</td>
      <td>13.0</td>
      <td>25.0</td>
      <td>38.00</td>
      <td>175.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="asid">
<h3><code class="docutils literal notranslate"><span class="pre">asid</span></code>列の深堀り<a class="headerlink" href="#asid" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mcnameごとのユニークなasid数と（参考情報として）acid数を集計して表示</span>
<span class="n">df_ae_crt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;mcname&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">n_as</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;asid&quot;</span><span class="p">,</span> <span class="s2">&quot;nunique&quot;</span><span class="p">),</span> <span class="n">n_ac</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;acid&quot;</span><span class="p">,</span> <span class="s2">&quot;nunique&quot;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>n_as</th>
      <th>n_ac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>週刊少年サンデー</td>
      <td>35</td>
      <td>56</td>
    </tr>
    <tr>
      <th>1</th>
      <td>週刊少年ジャンプ</td>
      <td>63</td>
      <td>104</td>
    </tr>
    <tr>
      <th>2</th>
      <td>週刊少年チャンピオン</td>
      <td>12</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>週刊少年マガジン</td>
      <td>42</td>
      <td>58</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;mcname&#39;（マンガ雑誌名）と&#39;asid&#39;（アニメシリーズID）でグループ化し、</span>
<span class="c1"># 各グループ内でユニークな&#39;atsname&#39;（放送枠名）の数を集計</span>
<span class="n">df_tmp</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_ae_crt</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;mcname&quot;</span><span class="p">,</span> <span class="s2">&quot;asid&quot;</span><span class="p">])[</span><span class="s2">&quot;atsname&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;n_ats&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># 上記で集計したデータを&#39;mcname&#39;（マンガ雑誌名）でさらにグループ化し、</span>
<span class="c1"># 各マンガ雑誌名ごとに放送枠の数（&#39;n_ats&#39;）の要約統計量を計算</span>
<span class="n">df_tmp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;mcname&quot;</span><span class="p">)[</span><span class="s2">&quot;n_ats&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>週刊少年サンデー</td>
      <td>35.0</td>
      <td>73.714286</td>
      <td>125.158857</td>
      <td>12.0</td>
      <td>26.50</td>
      <td>50.0</td>
      <td>56.5</td>
      <td>752.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>週刊少年ジャンプ</td>
      <td>63.0</td>
      <td>98.222222</td>
      <td>134.832446</td>
      <td>9.0</td>
      <td>31.00</td>
      <td>53.0</td>
      <td>98.5</td>
      <td>759.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>週刊少年チャンピオン</td>
      <td>12.0</td>
      <td>34.750000</td>
      <td>26.385688</td>
      <td>12.0</td>
      <td>13.00</td>
      <td>25.0</td>
      <td>49.5</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>週刊少年マガジン</td>
      <td>42.0</td>
      <td>43.761905</td>
      <td>51.435875</td>
      <td>11.0</td>
      <td>13.75</td>
      <td>26.0</td>
      <td>50.5</td>
      <td>277.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="n-ae">
<h3><code class="docutils literal notranslate"><span class="pre">n_ae</span></code>列の深掘り<a class="headerlink" href="#n-ae" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;date&#39;列でデータを昇順にソートし、新しいインデックスを付与</span>
<span class="c1"># これにより、日付が古い順にデータが並び替えられる</span>
<span class="n">df_ae_crt</span> <span class="o">=</span> <span class="n">df_ae_crt</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># &#39;acid&#39;列で重複するレコードを削除し、新しいインデックスを付与</span>
<span class="c1"># 各アニメ作品名(&#39;acid&#39;)に対して、最初に出現するレコードだけが保持される</span>
<span class="n">df_ac_crt</span> <span class="o">=</span> <span class="n">df_ae_crt</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;acid&quot;</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># n_ae列の要約統計量を算出</span>
<span class="c1"># reset_index()メソッドで、結果のインデックスをリセットして、それを新しいデータフレームとして取得</span>
<span class="n">df_ac_crt</span><span class="p">[</span><span class="s2">&quot;n_ae&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>n_ae</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>count</td>
      <td>238.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mean</td>
      <td>47.928571</td>
    </tr>
    <tr>
      <th>2</th>
      <td>std</td>
      <td>85.058723</td>
    </tr>
    <tr>
      <th>3</th>
      <td>min</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25%</td>
      <td>13.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>50%</td>
      <td>26.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>75%</td>
      <td>50.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max</td>
      <td>783.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># n_ae列の要約統計量を算出</span>
<span class="n">df_ac_crt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;mcname&quot;</span><span class="p">)[</span><span class="s2">&quot;n_ae&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>mcname</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>週刊少年サンデー</th>
      <td>56.0</td>
      <td>47.410714</td>
      <td>97.549573</td>
      <td>1.0</td>
      <td>20.50</td>
      <td>26.0</td>
      <td>50.00</td>
      <td>729.0</td>
    </tr>
    <tr>
      <th>週刊少年ジャンプ</th>
      <td>104.0</td>
      <td>61.471154</td>
      <td>102.619096</td>
      <td>1.0</td>
      <td>13.00</td>
      <td>26.0</td>
      <td>61.25</td>
      <td>783.0</td>
    </tr>
    <tr>
      <th>週刊少年チャンピオン</th>
      <td>20.0</td>
      <td>21.650000</td>
      <td>13.152046</td>
      <td>1.0</td>
      <td>12.75</td>
      <td>23.5</td>
      <td>25.25</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>週刊少年マガジン</th>
      <td>58.0</td>
      <td>33.206897</td>
      <td>31.871319</td>
      <td>2.0</td>
      <td>13.00</td>
      <td>26.0</td>
      <td>44.25</td>
      <td>175.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="first-datelast-date">
<h3><code class="docutils literal notranslate"><span class="pre">first_date</span></code>、<code class="docutils literal notranslate"><span class="pre">last_date</span></code>列の深掘り<a class="headerlink" href="#first-datelast-date" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ae_crtデータフレームから重複する行を削除し、指定された列だけを選択して新しいデータフレームdf_ac_datesを作成</span>
<span class="c1"># &#39;acid&#39;列を基準に重複を排除し、ignore_index=Trueで新しいインデックスを割り当て</span>
<span class="n">df_ac_dates</span> <span class="o">=</span> <span class="n">df_ae_crt</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;acid&quot;</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span>
    <span class="p">[</span><span class="s2">&quot;mcname&quot;</span><span class="p">,</span> <span class="s2">&quot;acname&quot;</span><span class="p">,</span> <span class="s2">&quot;first_date&quot;</span><span class="p">,</span> <span class="s2">&quot;last_date&quot;</span><span class="p">,</span> <span class="s2">&quot;n_ae&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># &#39;first_date&#39;列と&#39;last_date&#39;列のデータを日付型に変換</span>
<span class="n">df_ac_dates</span><span class="p">[</span><span class="s2">&quot;first_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_ac_dates</span><span class="p">[</span><span class="s2">&quot;first_date&quot;</span><span class="p">])</span>
<span class="n">df_ac_dates</span><span class="p">[</span><span class="s2">&quot;last_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_ac_dates</span><span class="p">[</span><span class="s2">&quot;last_date&quot;</span><span class="p">])</span>

<span class="c1"># &#39;last_date&#39;と&#39;first_date&#39;の差（期間）を計算して新しい列&#39;duration&#39;に保存</span>
<span class="n">df_ac_dates</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ac_dates</span><span class="p">[</span><span class="s2">&quot;last_date&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_ac_dates</span><span class="p">[</span><span class="s2">&quot;first_date&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first_dateとlast_dateの要約統計量を表示</span>
<span class="n">df_ac_dates</span><span class="p">[[</span><span class="s2">&quot;first_date&quot;</span><span class="p">,</span> <span class="s2">&quot;last_date&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_date</th>
      <th>last_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>238</td>
      <td>238</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2007-04-28 10:11:05.546218496</td>
      <td>2008-04-15 19:09:34.789915904</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1990-01-14 00:00:00</td>
      <td>1990-12-24 00:00:00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2002-05-18 00:00:00</td>
      <td>2004-03-21 12:00:00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2007-10-01 12:00:00</td>
      <td>2008-08-29 00:00:00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2013-06-16 06:00:00</td>
      <td>2014-03-29 18:00:00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2017-07-05 00:00:00</td>
      <td>2017-09-30 00:00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># duration列の要約統計量を取得し、reset_index()メソッドでDataFrame化して表示</span>
<span class="n">df_ac_dates</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>count</td>
      <td>238</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mean</td>
      <td>353 days 08:58:29.243697480</td>
    </tr>
    <tr>
      <th>2</th>
      <td>std</td>
      <td>683 days 01:53:27.886971808</td>
    </tr>
    <tr>
      <th>3</th>
      <td>min</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25%</td>
      <td>84 days 00:00:00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>50%</td>
      <td>175 days 00:00:00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>75%</td>
      <td>356 days 18:00:00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max</td>
      <td>6276 days 00:00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;duration&#39;列を&#39;n_ae&#39;列で割って、各レコードについての平均間隔（&#39;interval&#39;）を算出</span>
<span class="n">df_ac_dates</span><span class="p">[</span><span class="s2">&quot;interval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ac_dates</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_ac_dates</span><span class="p">[</span><span class="s2">&quot;n_ae&quot;</span><span class="p">]</span>

<span class="c1"># &#39;interval&#39;列に対して要約統計量を取得し、reset_index()メソッドでDataFrame化して表示</span>
<span class="n">df_ac_dates</span><span class="p">[</span><span class="s2">&quot;interval&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>interval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>count</td>
      <td>238</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mean</td>
      <td>7 days 01:29:51.880598083</td>
    </tr>
    <tr>
      <th>2</th>
      <td>std</td>
      <td>4 days 00:30:03.634059959</td>
    </tr>
    <tr>
      <th>3</th>
      <td>min</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25%</td>
      <td>6 days 11:04:36.923076923</td>
    </tr>
    <tr>
      <th>5</th>
      <td>50%</td>
      <td>6 days 19:41:32.307692307</td>
    </tr>
    <tr>
      <th>6</th>
      <td>75%</td>
      <td>7 days 05:34:17.142857142</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max</td>
      <td>54 days 16:00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># intervalで昇順にソートし、上位5作品を表示</span>
<span class="n">df_ac_dates</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;interval&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>acname</th>
      <th>first_date</th>
      <th>last_date</th>
      <th>n_ae</th>
      <th>duration</th>
      <th>interval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>153</th>
      <td>週刊少年チャンピオン</td>
      <td>みつ どもえ 特別編</td>
      <td>2011-03-07</td>
      <td>2011-03-07</td>
      <td>1</td>
      <td>0 days</td>
      <td>0 days</td>
    </tr>
    <tr>
      <th>94</th>
      <td>週刊少年ジャンプ</td>
      <td>こちら葛飾区 亀有公園前 派出所 [スペシャル] 走れ! 両津式チンチン電車 ～思い出の大次郎号～</td>
      <td>2006-04-02</td>
      <td>2006-04-02</td>
      <td>1</td>
      <td>0 days</td>
      <td>0 days</td>
    </tr>
    <tr>
      <th>142</th>
      <td>週刊少年サンデー</td>
      <td>まじっく快斗 KID THE PHANTOM THIEF 第1話 「蘇る怪盗」</td>
      <td>2010-04-17</td>
      <td>2010-04-17</td>
      <td>1</td>
      <td>0 days</td>
      <td>0 days</td>
    </tr>
    <tr>
      <th>103</th>
      <td>週刊少年ジャンプ</td>
      <td>こちら葛飾区 亀有公園前 派出所 [スペシャル] 両津の 浅草リニューアル 大作戦!! ～あ...</td>
      <td>2006-09-24</td>
      <td>2006-09-24</td>
      <td>1</td>
      <td>0 days</td>
      <td>0 days</td>
    </tr>
    <tr>
      <th>215</th>
      <td>週刊少年マガジン</td>
      <td>金田一 少年の 事件簿R Special 明智警部の事件簿</td>
      <td>2015-12-26</td>
      <td>2015-12-26</td>
      <td>2</td>
      <td>0 days</td>
      <td>0 days</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># intervalで降順にソートし、上位5作品を表示</span>
<span class="n">df_ac_dates</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;interval&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>acname</th>
      <th>first_date</th>
      <th>last_date</th>
      <th>n_ae</th>
      <th>duration</th>
      <th>interval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>93</th>
      <td>週刊少年ジャンプ</td>
      <td>聖闘士星矢冥王 ハーデス冥界編[後章]</td>
      <td>2006-01-21</td>
      <td>2006-12-15</td>
      <td>6</td>
      <td>328 days</td>
      <td>54 days 16:00:00</td>
    </tr>
    <tr>
      <th>0</th>
      <td>週刊少年ジャンプ</td>
      <td>シティーハンター3</td>
      <td>1990-01-14</td>
      <td>1990-12-24</td>
      <td>13</td>
      <td>344 days</td>
      <td>26 days 11:04:36.923076923</td>
    </tr>
    <tr>
      <th>124</th>
      <td>週刊少年ジャンプ</td>
      <td>聖闘士星矢冥王 ハーデスエリシオン編</td>
      <td>2008-03-07</td>
      <td>2008-08-01</td>
      <td>6</td>
      <td>147 days</td>
      <td>24 days 12:00:00</td>
    </tr>
    <tr>
      <th>169</th>
      <td>週刊少年ジャンプ</td>
      <td>銀魂'[延長戦]</td>
      <td>2012-10-04</td>
      <td>2013-03-28</td>
      <td>13</td>
      <td>175 days</td>
      <td>13 days 11:04:36.923076923</td>
    </tr>
    <tr>
      <th>90</th>
      <td>週刊少年サンデー</td>
      <td>メジャー[第2期]</td>
      <td>2005-12-10</td>
      <td>2007-01-03</td>
      <td>30</td>
      <td>389 days</td>
      <td>12 days 23:12:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># acnameがシティーハンター3と一致するレコードを抽出し、一部の列を表示</span>
<span class="n">df_ae_crt</span><span class="p">[</span><span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;acname&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;シティーハンター3&quot;</span><span class="p">][[</span><span class="s2">&quot;aeno&quot;</span><span class="p">,</span> <span class="s2">&quot;aename&quot;</span><span class="p">,</span> <span class="s2">&quot;date&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aeno</th>
      <th>aename</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12</td>
      <td>（126） グッバイCITY さよならの 贈りもの （前 編）</td>
      <td>1990-01-14</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13</td>
      <td>（127） グッバイCITY さよならの 贈りもの （後 編）</td>
      <td>1990-01-21</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>（115） 脱モッコリ宣言！ XYZは世界を救う</td>
      <td>1990-10-15</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2</td>
      <td>（116） 天下の恋愛現行犯！ 美人弁護士をくどく法</td>
      <td>1990-10-22</td>
    </tr>
    <tr>
      <th>15</th>
      <td>3</td>
      <td>（117） 香もプッツン！ 僚*と令嬢代打結婚物語""</td>
      <td>1990-10-29</td>
    </tr>
    <tr>
      <th>17</th>
      <td>4</td>
      <td>（118） 危ない探偵ごっこ! お嬢さんにパイソンを （前 編）</td>
      <td>1990-11-05</td>
    </tr>
    <tr>
      <th>20</th>
      <td>5</td>
      <td>（119） 危ない探偵ごっこ! お嬢さんにパイソンを （後 編）</td>
      <td>1990-11-12</td>
    </tr>
    <tr>
      <th>23</th>
      <td>6</td>
      <td>（120） がんこな海坊主! ジェラシー子猫物語</td>
      <td>1990-11-19</td>
    </tr>
    <tr>
      <th>26</th>
      <td>7</td>
      <td>（121） 恋はダイビング! 美女が水着に着がえたら</td>
      <td>1990-11-26</td>
    </tr>
    <tr>
      <th>29</th>
      <td>8</td>
      <td>（122） 僚*って何者？ 女子大生もスリルにメロメロ</td>
      <td>1990-12-03</td>
    </tr>
    <tr>
      <th>32</th>
      <td>9</td>
      <td>（123） 雨のち晴の恋予報! 美人キャスタに愛の傘</td>
      <td>1990-12-10</td>
    </tr>
    <tr>
      <th>35</th>
      <td>10</td>
      <td>（124） クリスマスに ウェディング ドレスを… （前 編）</td>
      <td>1990-12-17</td>
    </tr>
    <tr>
      <th>38</th>
      <td>11</td>
      <td>（125） クリスマスに ウェディング ドレスを… （後 編）</td>
      <td>1990-12-24</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="ccidccname">
<h3><code class="docutils literal notranslate"><span class="pre">ccid</span></code>、<code class="docutils literal notranslate"><span class="pre">ccname</span></code>列の深掘り<a class="headerlink" href="#ccidccname" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ae_crtから重複する&#39;acid&#39;（アニメ作品名）を削除し、</span>
<span class="c1"># &#39;ccname&#39;と&#39;acname&#39;の列だけを選択して新しいデータフレームを作成</span>
<span class="n">df_ccname_acname</span> <span class="o">=</span> <span class="n">df_ae_crt</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;acid&quot;</span><span class="p">])[</span>
    <span class="p">[</span><span class="s2">&quot;mcname&quot;</span><span class="p">,</span> <span class="s2">&quot;ccname&quot;</span><span class="p">,</span> <span class="s2">&quot;acname&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 新しいデータフレームに対して、&#39;ccname&#39;と&#39;acname&#39;の文字列間の類似度を計算し、</span>
<span class="c1"># その結果を&#39;similarity&#39;列として追加</span>
<span class="c1"># ここで、1は完全一致、0は全く異なる場合を意味する</span>
<span class="n">df_ccname_acname</span><span class="p">[</span><span class="s2">&quot;similarity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ccname_acname</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">difflib</span><span class="o">.</span><span class="n">SequenceMatcher</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;ccname&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;acname&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">ratio</span><span class="p">(),</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 類似度が低いアニメ作品を10レコード表示</span>
<span class="n">df_ccname_acname</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;similarity&quot;</span><span class="p">,</span> <span class="s2">&quot;ccname&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>ccname</th>
      <th>acname</th>
      <th>similarity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>194</th>
      <td>週刊少年ジャンプ</td>
      <td>DRAGON　BALL</td>
      <td>ドラゴンボール改[第2期]</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>80</th>
      <td>週刊少年サンデー</td>
      <td>MAJOR</td>
      <td>メジャー</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>90</th>
      <td>週刊少年サンデー</td>
      <td>MAJOR</td>
      <td>メジャー[第2期]</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>110</th>
      <td>週刊少年サンデー</td>
      <td>MAJOR</td>
      <td>メジャー[第3期]</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>121</th>
      <td>週刊少年サンデー</td>
      <td>MAJOR</td>
      <td>メジャー[第4期]</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>130</th>
      <td>週刊少年サンデー</td>
      <td>MAJOR</td>
      <td>メジャー[第5期]</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>141</th>
      <td>週刊少年サンデー</td>
      <td>MAJOR</td>
      <td>メジャー[第6期]</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75</th>
      <td>週刊少年マガジン</td>
      <td>スクールランブル</td>
      <td>School Rumble</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>95</th>
      <td>週刊少年マガジン</td>
      <td>スクールランブル</td>
      <td>School Rumble 二学期</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>34</th>
      <td>週刊少年ジャンプ</td>
      <td>HUNTER×HUNTER</td>
      <td>ハンター×ハンター</td>
      <td>0.090909</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ccname_acnameデータフレームの&#39;similarity&#39;列を選択し、要約統計量を取得</span>
<span class="c1"># reset_index()メソッドで、結果のインデックスをリセットして、それを新しいデータフレームとして取得</span>
<span class="n">df_ccname_acname</span><span class="p">[</span><span class="s2">&quot;similarity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>similarity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>count</td>
      <td>238.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mean</td>
      <td>0.723755</td>
    </tr>
    <tr>
      <th>2</th>
      <td>std</td>
      <td>0.287821</td>
    </tr>
    <tr>
      <th>3</th>
      <td>min</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25%</td>
      <td>0.533333</td>
    </tr>
    <tr>
      <th>5</th>
      <td>50%</td>
      <td>0.800000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>75%</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mcnameごとにsimilarity列の要約統計量を算出</span>
<span class="n">df_ccname_acname</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;mcname&quot;</span><span class="p">)[</span><span class="s2">&quot;similarity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>mcname</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>週刊少年サンデー</th>
      <td>56.0</td>
      <td>0.659172</td>
      <td>0.349151</td>
      <td>0.0</td>
      <td>0.369048</td>
      <td>0.732143</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>週刊少年ジャンプ</th>
      <td>104.0</td>
      <td>0.768607</td>
      <td>0.234002</td>
      <td>0.0</td>
      <td>0.608037</td>
      <td>0.800000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>週刊少年チャンピオン</th>
      <td>20.0</td>
      <td>0.750598</td>
      <td>0.273587</td>
      <td>0.2</td>
      <td>0.571429</td>
      <td>0.850000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>週刊少年マガジン</th>
      <td>58.0</td>
      <td>0.696430</td>
      <td>0.306820</td>
      <td>0.0</td>
      <td>0.463801</td>
      <td>0.800000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mcnameが週刊少年サンデーに一致するレコードに対して、similarityを基準に昇順ソート</span>
<span class="c1"># 上位10作品を表示</span>
<span class="n">df_ccname_acname</span><span class="p">[</span><span class="n">df_ccname_acname</span><span class="p">[</span><span class="s2">&quot;mcname&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;週刊少年サンデー&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
    <span class="s2">&quot;similarity&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>ccname</th>
      <th>acname</th>
      <th>similarity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>121</th>
      <td>週刊少年サンデー</td>
      <td>MAJOR</td>
      <td>メジャー[第4期]</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>80</th>
      <td>週刊少年サンデー</td>
      <td>MAJOR</td>
      <td>メジャー</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>110</th>
      <td>週刊少年サンデー</td>
      <td>MAJOR</td>
      <td>メジャー[第3期]</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>130</th>
      <td>週刊少年サンデー</td>
      <td>MAJOR</td>
      <td>メジャー[第5期]</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>141</th>
      <td>週刊少年サンデー</td>
      <td>MAJOR</td>
      <td>メジャー[第6期]</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>90</th>
      <td>週刊少年サンデー</td>
      <td>MAJOR</td>
      <td>メジャー[第2期]</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>週刊少年サンデー</td>
      <td>ゴーストスイーパー美神 極楽大作戦!!</td>
      <td>GS美神</td>
      <td>0.173913</td>
    </tr>
    <tr>
      <th>170</th>
      <td>週刊少年サンデー</td>
      <td>ハヤテのごとく!</td>
      <td>ハヤテのごとく! Hayate the combat buttler CAN'T TAKE ...</td>
      <td>0.231884</td>
    </tr>
    <tr>
      <th>206</th>
      <td>週刊少年サンデー</td>
      <td>電波教師</td>
      <td>電波教師 HE IS AN ULTIMATE TEACHER</td>
      <td>0.235294</td>
    </tr>
    <tr>
      <th>54</th>
      <td>週刊少年サンデー</td>
      <td>ARMS</td>
      <td>PROJECT ARMS The 2nd Chapter</td>
      <td>0.250000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="mcname">
<h3><code class="docutils literal notranslate"><span class="pre">mcname</span></code>列の深堀り<a class="headerlink" href="#mcname" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ae_crtデータフレームを&#39;mcname&#39;列に基づいてグループ化し、</span>
<span class="c1"># [[...]].nunique()で、指定された列について各グループ内のユニークな値の数を計算</span>
<span class="n">df_ae_crt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;mcname&quot;</span><span class="p">)[[</span><span class="s2">&quot;aeid&quot;</span><span class="p">,</span> <span class="s2">&quot;acid&quot;</span><span class="p">,</span> <span class="s2">&quot;asid&quot;</span><span class="p">,</span> <span class="s2">&quot;ccid&quot;</span><span class="p">,</span> <span class="s2">&quot;crtid&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aeid</th>
      <th>acid</th>
      <th>asid</th>
      <th>ccid</th>
      <th>crtid</th>
    </tr>
    <tr>
      <th>mcname</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>週刊少年サンデー</th>
      <td>2655</td>
      <td>56</td>
      <td>35</td>
      <td>37</td>
      <td>34</td>
    </tr>
    <tr>
      <th>週刊少年ジャンプ</th>
      <td>6393</td>
      <td>104</td>
      <td>63</td>
      <td>64</td>
      <td>64</td>
    </tr>
    <tr>
      <th>週刊少年チャンピオン</th>
      <td>433</td>
      <td>20</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
    </tr>
    <tr>
      <th>週刊少年マガジン</th>
      <td>1926</td>
      <td>58</td>
      <td>42</td>
      <td>43</td>
      <td>43</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="crtidcrtname">
<h3><code class="docutils literal notranslate"><span class="pre">crtid</span></code>、<code class="docutils literal notranslate"><span class="pre">crtname</span></code>列の深掘り<a class="headerlink" href="#crtidcrtname" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># groupby([&quot;crtid&quot;, &quot;crtname&quot;])で、これらの列の組み合わせごとにデータをグループ化</span>
<span class="c1"># .nunique()で、指定された列について各グループ内のユニークな値の数を計算</span>
<span class="c1"># .reset_index()で、結果のインデックスをリセットして、それを新しいデータフレームとして取得</span>
<span class="n">df_crt_nunique</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_ae_crt</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;crtid&quot;</span><span class="p">,</span> <span class="s2">&quot;crtname&quot;</span><span class="p">])[[</span><span class="s2">&quot;asid&quot;</span><span class="p">,</span> <span class="s2">&quot;acid&quot;</span><span class="p">,</span> <span class="s2">&quot;aeid&quot;</span><span class="p">,</span> <span class="s2">&quot;date&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="p">)</span>

<span class="c1"># 計算したユニークな値の数について、&#39;asid&#39;, &#39;acid&#39;, &#39;aeid&#39;, &#39;date&#39;の各列の統計的な要約を取得</span>
<span class="n">df_crt_nunique</span><span class="p">[[</span><span class="s2">&quot;asid&quot;</span><span class="p">,</span> <span class="s2">&quot;acid&quot;</span><span class="p">,</span> <span class="s2">&quot;aeid&quot;</span><span class="p">,</span> <span class="s2">&quot;date&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>asid</th>
      <th>acid</th>
      <th>aeid</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>154.000000</td>
      <td>154.000000</td>
      <td>154.000000</td>
      <td>154.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.168831</td>
      <td>1.792208</td>
      <td>82.467532</td>
      <td>79.610390</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.454537</td>
      <td>1.255968</td>
      <td>121.545665</td>
      <td>116.732436</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>11.000000</td>
      <td>7.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>26.000000</td>
      <td>26.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>49.000000</td>
      <td>47.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>76.000000</td>
      <td>74.750000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.000000</td>
      <td>8.000000</td>
      <td>806.000000</td>
      <td>782.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># アニメ作品数で降順ソートし、上位5名を表示</span>
<span class="n">df_crt_nunique</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;acid&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crtid</th>
      <th>crtname</th>
      <th>asid</th>
      <th>acid</th>
      <th>aeid</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>117</th>
      <td>CCRT02724</td>
      <td>秋本治</td>
      <td>1</td>
      <td>8</td>
      <td>209</td>
      <td>207</td>
    </tr>
    <tr>
      <th>59</th>
      <td>CCRT01512</td>
      <td>小畑健</td>
      <td>4</td>
      <td>6</td>
      <td>220</td>
      <td>218</td>
    </tr>
    <tr>
      <th>100</th>
      <td>CCRT02446</td>
      <td>満田拓也</td>
      <td>1</td>
      <td>6</td>
      <td>160</td>
      <td>159</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CCRT00188</td>
      <td>さとうふみや</td>
      <td>2</td>
      <td>6</td>
      <td>258</td>
      <td>244</td>
    </tr>
    <tr>
      <th>47</th>
      <td>CCRT01321</td>
      <td>天樹征丸</td>
      <td>2</td>
      <td>6</td>
      <td>258</td>
      <td>244</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># crtnameが秋本治と一致するレコードのうち、acnameごとに先頭の行を抽出し、特定の列のみ表示</span>
<span class="n">df_ae_crt</span><span class="p">[</span><span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;crtname&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;秋本治&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;acname&quot;</span><span class="p">)[</span>
    <span class="p">[</span><span class="s2">&quot;n_ae&quot;</span><span class="p">,</span> <span class="s2">&quot;first_date&quot;</span><span class="p">,</span> <span class="s2">&quot;ccname&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n_ae</th>
      <th>first_date</th>
      <th>ccname</th>
    </tr>
    <tr>
      <th>acname</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>こちら葛*飾区 亀有公園前 派出所［2016年スペシャル］</th>
      <td>1</td>
      <td>2016-09-18</td>
      <td>こちら葛飾区亀有公園前派出所</td>
    </tr>
    <tr>
      <th>こちら葛*飾区亀有公園前派出所[10月SP]</th>
      <td>2</td>
      <td>2008-10-26</td>
      <td>こちら葛飾区亀有公園前派出所</td>
    </tr>
    <tr>
      <th>こちら葛*飾区亀有公園前派出所[4月SP]</th>
      <td>2</td>
      <td>2008-04-06</td>
      <td>こちら葛飾区亀有公園前派出所</td>
    </tr>
    <tr>
      <th>こちら葛飾区 亀有公園前 派出所 [スペシャル] 両津の 浅草リニューアル 大作戦!! ～あぁ 思い出の花やしき～</th>
      <td>1</td>
      <td>2006-09-24</td>
      <td>こちら葛飾区亀有公園前派出所</td>
    </tr>
    <tr>
      <th>こちら葛飾区 亀有公園前 派出所 [スペシャル] 走れ! 両津式チンチン電車 ～思い出の大次郎号～</th>
      <td>1</td>
      <td>2006-04-02</td>
      <td>こちら葛飾区亀有公園前派出所</td>
    </tr>
    <tr>
      <th>こちら葛飾区亀有公園前派出所</th>
      <td>198</td>
      <td>1999-12-05</td>
      <td>こちら葛飾区亀有公園前派出所</td>
    </tr>
    <tr>
      <th>こちら葛飾区亀有公園前派出所 シートン探検隊!隅田川の誓い～思い出の白い鯨を探せ!～</th>
      <td>2</td>
      <td>2007-08-05</td>
      <td>こちら葛飾区亀有公園前派出所</td>
    </tr>
    <tr>
      <th>こちら葛飾区亀有公園前派出所 両さんの寿司食いねぇ!～頂上マグロ対決!!～</th>
      <td>2</td>
      <td>2007-09-30</td>
      <td>こちら葛飾区亀有公園前派出所</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># アニメシリーズ数で降順ソートし、上位5名を表示</span>
<span class="n">df_crt_nunique</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;asid&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crtid</th>
      <th>crtname</th>
      <th>asid</th>
      <th>acid</th>
      <th>aeid</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>59</th>
      <td>CCRT01512</td>
      <td>小畑健</td>
      <td>4</td>
      <td>6</td>
      <td>220</td>
      <td>218</td>
    </tr>
    <tr>
      <th>102</th>
      <td>CCRT02471</td>
      <td>瀬尾公治</td>
      <td>3</td>
      <td>3</td>
      <td>50</td>
      <td>50</td>
    </tr>
    <tr>
      <th>29</th>
      <td>CCRT00957</td>
      <td>冨樫義博</td>
      <td>3</td>
      <td>4</td>
      <td>336</td>
      <td>336</td>
    </tr>
    <tr>
      <th>84</th>
      <td>CCRT02215</td>
      <td>椎名高志</td>
      <td>2</td>
      <td>2</td>
      <td>97</td>
      <td>97</td>
    </tr>
    <tr>
      <th>139</th>
      <td>CCRT03016</td>
      <td>赤松健</td>
      <td>2</td>
      <td>2</td>
      <td>50</td>
      <td>50</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># crtnameが小畑健と一致するレコードのうち、asidごとに先頭の行を抽出し、特定の列のみ表示</span>
<span class="n">df_ae_crt</span><span class="p">[</span><span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;crtname&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;小畑健&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;asid&quot;</span><span class="p">)[</span>
    <span class="p">[</span><span class="s2">&quot;acname&quot;</span><span class="p">,</span> <span class="s2">&quot;n_ae&quot;</span><span class="p">,</span> <span class="s2">&quot;first_date&quot;</span><span class="p">,</span> <span class="s2">&quot;ccname&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acname</th>
      <th>n_ae</th>
      <th>first_date</th>
      <th>ccname</th>
    </tr>
    <tr>
      <th>asid</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C2285</th>
      <td>人形[からくり]草紙 あやつり 左近</td>
      <td>26</td>
      <td>1999-08-16</td>
      <td>人形草子あやつり左近</td>
    </tr>
    <tr>
      <th>C2531</th>
      <td>ヒカルの碁</td>
      <td>76</td>
      <td>2001-10-10</td>
      <td>ヒカルの碁</td>
    </tr>
    <tr>
      <th>C3898</th>
      <td>DEATH NOTE</td>
      <td>39</td>
      <td>2006-10-04</td>
      <td>DEATH NOTE</td>
    </tr>
    <tr>
      <th>C4435</th>
      <td>バクマン。[第1期]</td>
      <td>27</td>
      <td>2010-10-02</td>
      <td>バクマン。</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># crtnameが高橋留美子と一致するレコードのうち、asidごとに先頭の行を抽出し、特定の列のみ表示</span>
<span class="n">df_ae_crt</span><span class="p">[</span><span class="n">df_ae_crt</span><span class="p">[</span><span class="s2">&quot;crtname&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;高橋留美子&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;asid&quot;</span><span class="p">)[</span>
    <span class="p">[</span><span class="s2">&quot;acname&quot;</span><span class="p">,</span> <span class="s2">&quot;n_ae&quot;</span><span class="p">,</span> <span class="s2">&quot;first_date&quot;</span><span class="p">,</span> <span class="s2">&quot;ccname&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acname</th>
      <th>n_ae</th>
      <th>first_date</th>
      <th>ccname</th>
    </tr>
    <tr>
      <th>asid</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C2413</th>
      <td>犬夜叉</td>
      <td>171</td>
      <td>2000-10-16</td>
      <td>犬夜叉</td>
    </tr>
    <tr>
      <th>C5983</th>
      <td>境界の RINNE</td>
      <td>26</td>
      <td>2015-03-22</td>
      <td>境界のRINNE</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># grepコマンドで、うる星やつらを含む文字列をae_dropped.csvから抽出</span>
<span class="o">!</span>grep<span class="w"> </span>うる星やつら<span class="w"> </span>../../../data/an/interim/ae_dropped.csv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M22149,,,,C7956,うる星やつら,C5678
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># grepコマンドで、めぞん一刻を含む文字列をae_dropped.csvから抽出</span>
<span class="o">!</span>grep<span class="w"> </span>めぞん一刻<span class="w"> </span>../../../data/an/interim/ae_dropped.csv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M22488,,,,C8305,めぞん一刻,C6857
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># grepコマンドで、らんま1/2を含む文字列をae_dropped.csvから抽出</span>
<span class="o">!</span>grep<span class="w"> </span>らんま1/2<span class="w"> </span>../../../data/an/interim/ae_dropped.csv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M23689,,,,C8055,らんま1/2,C7122
M23753,&quot;・第1話/激突! 出前格闘レース（1989/10/20）,・第2話/やっぱり猫が嫌い?（1989/11/03）,・第3話/私が女傑族のおばば!（1989/11/10）,・第4話/出た! 必殺天津甘栗拳!!（1989/11/17）,・第5話/白鳥拳の男ムース登場!（1989/11/24）,・第6話/爆走! 雪だるま運びレース（1989/12/01）,・第7話/さらわれたPちゃん!（1989/12/08）,・第8話/危機一髪! 死霊の盆踊り（1989/12/15）&lt;B&quot;,,,C8595,らんま1/2 熱闘編,C7122
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="mix-ce-ac-csv">
<h2><code class="docutils literal notranslate"><span class="pre">mix_ce_ac.csv</span></code>の基礎分析<a class="headerlink" href="#mix-ce-ac-csv" title="Link to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pandasのread_csv関数でCSVファイルの読み込み</span>
<span class="n">df_ce_ac</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DIR_IN</span> <span class="o">/</span> <span class="n">FN_CE_AC</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="id6">
<h3>全体像の把握<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ce_acデータフレームの先頭5行を表示</span>
<span class="c1"># headメソッドはデータの概観を確認するのに便利</span>
<span class="n">df_ce_ac</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ceid</th>
      <td>CE00000</td>
      <td>CE00026</td>
      <td>CE00062</td>
      <td>CE00086</td>
      <td>CE00112</td>
    </tr>
    <tr>
      <th>cename</th>
      <td>第238話/この世代</td>
      <td>第237話/トーナメント</td>
      <td>第236話/絆</td>
      <td>第235話/指先から…</td>
      <td>第234話/何にも出来ないワケじゃない</td>
    </tr>
    <tr>
      <th>ccid</th>
      <td>C90829</td>
      <td>C90829</td>
      <td>C90829</td>
      <td>C90829</td>
      <td>C90829</td>
    </tr>
    <tr>
      <th>miid</th>
      <td>M535428</td>
      <td>M535429</td>
      <td>M535430</td>
      <td>M535431</td>
      <td>M535432</td>
    </tr>
    <tr>
      <th>page_start</th>
      <td>10.0</td>
      <td>125.0</td>
      <td>223.0</td>
      <td>183.0</td>
      <td>221.0</td>
    </tr>
    <tr>
      <th>page_end</th>
      <td>31.0</td>
      <td>144.0</td>
      <td>242.0</td>
      <td>204.0</td>
      <td>240.0</td>
    </tr>
    <tr>
      <th>pages</th>
      <td>22.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>22.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>page_start_position</th>
      <td>0.021368</td>
      <td>0.23855</td>
      <td>0.478541</td>
      <td>0.405765</td>
      <td>0.472222</td>
    </tr>
    <tr>
      <th>two_colored</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>four_colored</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>date</th>
      <td>2011-05-25</td>
      <td>2011-05-18</td>
      <td>2011-05-04</td>
      <td>2011-04-27</td>
      <td>2011-04-20</td>
    </tr>
    <tr>
      <th>ccname</th>
      <td>ダイヤのA</td>
      <td>ダイヤのA</td>
      <td>ダイヤのA</td>
      <td>ダイヤのA</td>
      <td>ダイヤのA</td>
    </tr>
    <tr>
      <th>n_ce</th>
      <td>425</td>
      <td>425</td>
      <td>425</td>
      <td>425</td>
      <td>425</td>
    </tr>
    <tr>
      <th>n_2c</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>n_4c</th>
      <td>39</td>
      <td>39</td>
      <td>39</td>
      <td>39</td>
      <td>39</td>
    </tr>
    <tr>
      <th>first_date_cc</th>
      <td>2006-05-31</td>
      <td>2006-05-31</td>
      <td>2006-05-31</td>
      <td>2006-05-31</td>
      <td>2006-05-31</td>
    </tr>
    <tr>
      <th>last_date_cc</th>
      <td>2016-01-08</td>
      <td>2016-01-08</td>
      <td>2016-01-08</td>
      <td>2016-01-08</td>
      <td>2016-01-08</td>
    </tr>
    <tr>
      <th>mcid</th>
      <td>C119033</td>
      <td>C119033</td>
      <td>C119033</td>
      <td>C119033</td>
      <td>C119033</td>
    </tr>
    <tr>
      <th>mcname</th>
      <td>週刊少年マガジン</td>
      <td>週刊少年マガジン</td>
      <td>週刊少年マガジン</td>
      <td>週刊少年マガジン</td>
      <td>週刊少年マガジン</td>
    </tr>
    <tr>
      <th>acid</th>
      <td>C14866</td>
      <td>C14866</td>
      <td>C14866</td>
      <td>C14866</td>
      <td>C14866</td>
    </tr>
    <tr>
      <th>acname</th>
      <td>ダイヤのA[エース]</td>
      <td>ダイヤのA[エース]</td>
      <td>ダイヤのA[エース]</td>
      <td>ダイヤのA[エース]</td>
      <td>ダイヤのA[エース]</td>
    </tr>
    <tr>
      <th>asid</th>
      <td>C5641</td>
      <td>C5641</td>
      <td>C5641</td>
      <td>C5641</td>
      <td>C5641</td>
    </tr>
    <tr>
      <th>n_ae</th>
      <td>75.0</td>
      <td>75.0</td>
      <td>75.0</td>
      <td>75.0</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>first_date_ac</th>
      <td>2013-10-06</td>
      <td>2013-10-06</td>
      <td>2013-10-06</td>
      <td>2013-10-06</td>
      <td>2013-10-06</td>
    </tr>
    <tr>
      <th>last_date_ac</th>
      <td>2015-03-29</td>
      <td>2015-03-29</td>
      <td>2015-03-29</td>
      <td>2015-03-29</td>
      <td>2015-03-29</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ce_acデータフレームの形状（行数・列数）を取得</span>
<span class="c1"># shape属性を使用すると、(行数, 列数)の形で結果が返される</span>
<span class="n">df_ce_ac</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(181681, 25)
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ce_acデータフレーム内の欠損値（NaN）の情報を集計</span>
<span class="c1"># isna()メソッドを使用して欠損値の場所をTrueとして特定</span>
<span class="c1"># その後、agg()メソッドを使用して、各列における欠損値の合計と平均を計算し転置して表示</span>
<span class="n">df_ce_ac</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="nb">sum</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sum</th>
      <th>mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ceid</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>cename</th>
      <td>27536.0</td>
      <td>0.151562</td>
    </tr>
    <tr>
      <th>ccid</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>miid</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>page_start</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>page_end</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>pages</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>page_start_position</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>two_colored</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>four_colored</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>date</th>
      <td>1614.0</td>
      <td>0.008884</td>
    </tr>
    <tr>
      <th>ccname</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>n_ce</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>n_2c</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>n_4c</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>first_date_cc</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>last_date_cc</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>mcid</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>mcname</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>acid</th>
      <td>138157.0</td>
      <td>0.760437</td>
    </tr>
    <tr>
      <th>acname</th>
      <td>138157.0</td>
      <td>0.760437</td>
    </tr>
    <tr>
      <th>asid</th>
      <td>138157.0</td>
      <td>0.760437</td>
    </tr>
    <tr>
      <th>n_ae</th>
      <td>138157.0</td>
      <td>0.760437</td>
    </tr>
    <tr>
      <th>first_date_ac</th>
      <td>138157.0</td>
      <td>0.760437</td>
    </tr>
    <tr>
      <th>last_date_ac</th>
      <td>138157.0</td>
      <td>0.760437</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ce_acデータフレームの記述統計情報を取得</span>
<span class="c1"># describe()メソッドを使用して、各列の中央値、平均、標準偏差などの基本的な統計量を転置表示</span>
<span class="n">df_ce_ac</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>page_start</th>
      <td>181681.0</td>
      <td>209.882924</td>
      <td>123.920451</td>
      <td>1.000000</td>
      <td>107.000000</td>
      <td>203.000000</td>
      <td>305.000000</td>
      <td>581.0</td>
    </tr>
    <tr>
      <th>page_end</th>
      <td>181681.0</td>
      <td>227.382651</td>
      <td>122.137365</td>
      <td>1.000000</td>
      <td>125.000000</td>
      <td>221.000000</td>
      <td>322.000000</td>
      <td>600.0</td>
    </tr>
    <tr>
      <th>pages</th>
      <td>181681.0</td>
      <td>18.499728</td>
      <td>7.712246</td>
      <td>1.000000</td>
      <td>17.000000</td>
      <td>19.000000</td>
      <td>20.000000</td>
      <td>487.0</td>
    </tr>
    <tr>
      <th>page_start_position</th>
      <td>181681.0</td>
      <td>0.514276</td>
      <td>0.283281</td>
      <td>0.002045</td>
      <td>0.273529</td>
      <td>0.519737</td>
      <td>0.759524</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>n_ce</th>
      <td>181681.0</td>
      <td>218.286887</td>
      <td>265.554237</td>
      <td>1.000000</td>
      <td>55.000000</td>
      <td>152.000000</td>
      <td>285.000000</td>
      <td>1968.0</td>
    </tr>
    <tr>
      <th>n_2c</th>
      <td>181681.0</td>
      <td>6.906451</td>
      <td>15.956542</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6.000000</td>
      <td>161.0</td>
    </tr>
    <tr>
      <th>n_4c</th>
      <td>181681.0</td>
      <td>16.014608</td>
      <td>26.655401</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>6.000000</td>
      <td>19.000000</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>n_ae</th>
      <td>43524.0</td>
      <td>98.339008</td>
      <td>156.534637</td>
      <td>1.000000</td>
      <td>25.000000</td>
      <td>46.000000</td>
      <td>97.000000</td>
      <td>783.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ce_acデータフレームの各列に対してユニークな値の数をカウント</span>
<span class="c1"># nunique()メソッドを使用して、各列のユニークな値の数を計算</span>
<span class="c1"># その後、結果を新しいデータフレームとして整形し、列名を&quot;nunique&quot;とする</span>
<span class="n">df_ce_ac</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;nunique&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>nunique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ceid</td>
      <td>181681</td>
    </tr>
    <tr>
      <th>1</th>
      <td>cename</td>
      <td>151204</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ccid</td>
      <td>6953</td>
    </tr>
    <tr>
      <th>3</th>
      <td>miid</td>
      <td>9822</td>
    </tr>
    <tr>
      <th>4</th>
      <td>page_start</td>
      <td>550</td>
    </tr>
    <tr>
      <th>5</th>
      <td>page_end</td>
      <td>568</td>
    </tr>
    <tr>
      <th>6</th>
      <td>pages</td>
      <td>123</td>
    </tr>
    <tr>
      <th>7</th>
      <td>page_start_position</td>
      <td>45726</td>
    </tr>
    <tr>
      <th>8</th>
      <td>two_colored</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>four_colored</td>
      <td>2</td>
    </tr>
    <tr>
      <th>10</th>
      <td>date</td>
      <td>6380</td>
    </tr>
    <tr>
      <th>11</th>
      <td>ccname</td>
      <td>6845</td>
    </tr>
    <tr>
      <th>12</th>
      <td>n_ce</td>
      <td>340</td>
    </tr>
    <tr>
      <th>13</th>
      <td>n_2c</td>
      <td>52</td>
    </tr>
    <tr>
      <th>14</th>
      <td>n_4c</td>
      <td>65</td>
    </tr>
    <tr>
      <th>15</th>
      <td>first_date_cc</td>
      <td>4376</td>
    </tr>
    <tr>
      <th>16</th>
      <td>last_date_cc</td>
      <td>4160</td>
    </tr>
    <tr>
      <th>17</th>
      <td>mcid</td>
      <td>4</td>
    </tr>
    <tr>
      <th>18</th>
      <td>mcname</td>
      <td>4</td>
    </tr>
    <tr>
      <th>19</th>
      <td>acid</td>
      <td>157</td>
    </tr>
    <tr>
      <th>20</th>
      <td>acname</td>
      <td>157</td>
    </tr>
    <tr>
      <th>21</th>
      <td>asid</td>
      <td>152</td>
    </tr>
    <tr>
      <th>22</th>
      <td>n_ae</td>
      <td>63</td>
    </tr>
    <tr>
      <th>23</th>
      <td>first_date_ac</td>
      <td>147</td>
    </tr>
    <tr>
      <th>24</th>
      <td>last_date_ac</td>
      <td>151</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="id7">
<h3><code class="docutils literal notranslate"><span class="pre">date</span></code>列の深堀り<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># year列に年情報を追加</span>
<span class="n">df_ce_ac</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_ce_ac</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;acname&#39;列の欠損値（NaN）の有無に基づいて、新しい列&#39;is_animated&#39;を作成</span>
<span class="c1"># &#39;acname&#39;列に値があればTrue（アニメーションあり）、欠損値ならFalse（アニメーションなし）</span>
<span class="n">df_ce_ac</span><span class="p">[</span><span class="s2">&quot;is_animated&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">~</span><span class="n">df_ce_ac</span><span class="p">[</span><span class="s2">&quot;acname&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>

<span class="c1"># date列から年情報を抜き出し、year列として格納</span>
<span class="n">df_ce_ac</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_ce_ac</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="c1"># year列を5年ごとに集計するためのyears列を追加</span>
<span class="n">unit_years</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">df_ce_ac</span><span class="p">[</span><span class="s2">&quot;years&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ce_ac</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">//</span> <span class="n">unit_years</span> <span class="o">*</span> <span class="n">unit_years</span>
<span class="c1"># yearsごとにis_animatedの平均値を算出</span>
<span class="n">df_ce_ac</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;years&quot;</span><span class="p">)[</span><span class="s2">&quot;is_animated&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>years</th>
      <th>is_animated</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1970.0</td>
      <td>0.053436</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1975.0</td>
      <td>0.070777</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1980.0</td>
      <td>0.073442</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1985.0</td>
      <td>0.099111</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1990.0</td>
      <td>0.189754</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1995.0</td>
      <td>0.280905</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2000.0</td>
      <td>0.340570</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2005.0</td>
      <td>0.362271</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2010.0</td>
      <td>0.404778</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2015.0</td>
      <td>0.323192</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="ceidcename">
<h3><code class="docutils literal notranslate"><span class="pre">ceid</span></code>、<code class="docutils literal notranslate"><span class="pre">cename</span></code>列の深掘り<a class="headerlink" href="#ceidcename" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;is_animated&#39;列（アニメーションがあるかないか）に基づいてデータをグループ化し、</span>
<span class="c1"># &#39;ceid&#39;のユニークな値の数をそれぞれのグループで計算</span>
<span class="c1"># .reset_index()で、結果のインデックスをリセットして、それを新しいデータフレームとして取得</span>
<span class="n">df_ce_ac</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;is_animated&quot;</span><span class="p">)[</span><span class="s2">&quot;ceid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_animated</th>
      <th>ceid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>138157</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>43524</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ce_acデータフレームを&#39;mcname&#39;に基づいてグループ化し、&#39;is_animated&#39;列に対して集約関数を適用</span>
<span class="c1"># .reset_index()で、結果のインデックスをリセットして、それを新しいデータフレームとして取得</span>
<span class="n">df_ce_ac</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;mcname&quot;</span><span class="p">)[</span><span class="s2">&quot;is_animated&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>count</th>
      <th>sum</th>
      <th>mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>週刊少年サンデー</td>
      <td>46491</td>
      <td>10240</td>
      <td>0.220258</td>
    </tr>
    <tr>
      <th>1</th>
      <td>週刊少年ジャンプ</td>
      <td>43371</td>
      <td>18167</td>
      <td>0.418874</td>
    </tr>
    <tr>
      <th>2</th>
      <td>週刊少年チャンピオン</td>
      <td>45443</td>
      <td>3224</td>
      <td>0.070946</td>
    </tr>
    <tr>
      <th>3</th>
      <td>週刊少年マガジン</td>
      <td>46376</td>
      <td>11893</td>
      <td>0.256447</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="id8">
<h3><code class="docutils literal notranslate"><span class="pre">ccid</span></code>、<code class="docutils literal notranslate"><span class="pre">ccname</span></code>列の深掘り<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;is_animated&#39;列（アニメーションがあるかないか）に基づいてデータをグループ化し、</span>
<span class="c1"># &#39;ccid&#39;のユニークな値の数をそれぞれのグループで計算</span>
<span class="c1"># .reset_index()で、結果のインデックスをリセットして、それを新しいデータフレームとして取得</span>
<span class="n">df_ce_ac</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;is_animated&quot;</span><span class="p">)[</span><span class="s2">&quot;ccid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_animated</th>
      <th>ccid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>6796</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>157</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ce_acデータフレームから&#39;ccid&#39;列を基準に重複を削除し</span>
<span class="c1"># 新しいインデックスを割り当てて新しいデータフレームdf_tmpを作成</span>
<span class="n">df_tmp</span> <span class="o">=</span> <span class="n">df_ce_ac</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ccid&quot;</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># df_tmpデータフレームを&#39;mcname&#39;に基づいてグループ化し、</span>
<span class="c1"># &#39;is_animated&#39;列に対して複数の集約関数（カウント、合計、平均）を適用</span>
<span class="c1"># .reset_index()で、結果のインデックスをリセットして、それをさらに扱いやすい形に整形</span>
<span class="n">df_tmp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;mcname&quot;</span><span class="p">)[</span><span class="s2">&quot;is_animated&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>count</th>
      <th>sum</th>
      <th>mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>週刊少年サンデー</td>
      <td>1496</td>
      <td>37</td>
      <td>0.024733</td>
    </tr>
    <tr>
      <th>1</th>
      <td>週刊少年ジャンプ</td>
      <td>2129</td>
      <td>64</td>
      <td>0.030061</td>
    </tr>
    <tr>
      <th>2</th>
      <td>週刊少年チャンピオン</td>
      <td>1736</td>
      <td>13</td>
      <td>0.007488</td>
    </tr>
    <tr>
      <th>3</th>
      <td>週刊少年マガジン</td>
      <td>1592</td>
      <td>43</td>
      <td>0.027010</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="miid">
<h3><code class="docutils literal notranslate"><span class="pre">miid</span></code>列の深掘り<a class="headerlink" href="#miid" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ce_acデータフレームから&#39;miid&#39;と&#39;ccname&#39;の組み合わせで重複を削除し</span>
<span class="c1"># 新しいインデックスを割り当てて新しいデータフレームdf_tmpを作成</span>
<span class="c1"># （特別企画等で同一マンガ作品が複数回掲載されているパターンがあるため）</span>
<span class="n">df_tmp</span> <span class="o">=</span> <span class="n">df_ce_ac</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;miid&quot;</span><span class="p">,</span> <span class="s2">&quot;ccname&quot;</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># df_tmpデータフレームを&#39;mcname&#39;と&#39;miid&#39;に基づいてグループ化し</span>
<span class="c1"># &#39;is_animated&#39;列に対して合計と平均を計算</span>
<span class="c1"># .reset_index()で、結果のインデックスをリセット</span>
<span class="n">df_mi_animated</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_tmp</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;mcname&quot;</span><span class="p">,</span> <span class="s2">&quot;miid&quot;</span><span class="p">])[</span><span class="s2">&quot;is_animated&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="p">)</span>

<span class="c1"># 内容を表示</span>
<span class="n">df_mi_animated</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>miid</th>
      <th>count</th>
      <th>sum</th>
      <th>mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10107</th>
      <td>週刊少年マガジン</td>
      <td>M702008</td>
      <td>22</td>
      <td>6</td>
      <td>0.272727</td>
    </tr>
    <tr>
      <th>10108</th>
      <td>週刊少年マガジン</td>
      <td>M702009</td>
      <td>24</td>
      <td>7</td>
      <td>0.291667</td>
    </tr>
    <tr>
      <th>10109</th>
      <td>週刊少年マガジン</td>
      <td>M702010</td>
      <td>23</td>
      <td>5</td>
      <td>0.217391</td>
    </tr>
    <tr>
      <th>10110</th>
      <td>週刊少年マガジン</td>
      <td>M702011</td>
      <td>27</td>
      <td>9</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>10111</th>
      <td>週刊少年マガジン</td>
      <td>M702012</td>
      <td>24</td>
      <td>7</td>
      <td>0.291667</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sum、mean列について要約統計量を算出</span>
<span class="n">df_mi_animated</span><span class="p">[[</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sum</th>
      <th>mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>10112.000000</td>
      <td>10112.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4.255538</td>
      <td>0.212150</td>
    </tr>
    <tr>
      <th>std</th>
      <td>4.427726</td>
      <td>0.211994</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.000000</td>
      <td>0.130435</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>8.000000</td>
      <td>0.375000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>16.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># アニメ化作品数の順に降順ソートし、上位5巻号を表示</span>
<span class="n">df_mi_animated</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;miid&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>miid</th>
      <th>count</th>
      <th>sum</th>
      <th>mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4756</th>
      <td>週刊少年ジャンプ</td>
      <td>M616464</td>
      <td>21</td>
      <td>16</td>
      <td>0.761905</td>
    </tr>
    <tr>
      <th>2725</th>
      <td>週刊少年ジャンプ</td>
      <td>M542873</td>
      <td>21</td>
      <td>16</td>
      <td>0.761905</td>
    </tr>
    <tr>
      <th>2724</th>
      <td>週刊少年ジャンプ</td>
      <td>M542872</td>
      <td>21</td>
      <td>16</td>
      <td>0.761905</td>
    </tr>
    <tr>
      <th>2723</th>
      <td>週刊少年ジャンプ</td>
      <td>M542871</td>
      <td>21</td>
      <td>16</td>
      <td>0.761905</td>
    </tr>
    <tr>
      <th>2722</th>
      <td>週刊少年ジャンプ</td>
      <td>M542870</td>
      <td>21</td>
      <td>16</td>
      <td>0.761905</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># miidがM616464と一致し、かつアニメ化実績があるマンガ作品名一覧を取得</span>
<span class="n">df_ce_ac</span><span class="p">[(</span><span class="n">df_ce_ac</span><span class="p">[</span><span class="s2">&quot;miid&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;M616464&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">df_ce_ac</span><span class="p">[</span><span class="s2">&quot;is_animated&quot;</span><span class="p">]][</span><span class="s2">&quot;ccname&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;こちら葛飾区亀有公園前派出所&#39;, &#39;ONE PIECE&#39;, &#39;トリコ&#39;, &#39;NARUTO-ナルト-&#39;, &#39;SKET DANCE&#39;,
       &#39;銀魂&#39;, &#39;べるぜバブ&#39;, &#39;めだかボックス&#39;, &#39;BLEACH&#39;, &#39;黒子のバスケ&#39;, &#39;ハイキュー!!&#39;, &#39;ニセコイ&#39;,
       &#39;斉木楠雄のΨ難&#39;, &#39;暗殺教室&#39;, &#39;食戟のソーマ&#39;, &#39;ワールドトリガー&#39;], dtype=object)
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="page-startpage-endpagespage-start-position">
<h3><code class="docutils literal notranslate"><span class="pre">page_start</span></code>、<code class="docutils literal notranslate"><span class="pre">page_end</span></code>、<code class="docutils literal notranslate"><span class="pre">pages</span></code>、<code class="docutils literal notranslate"><span class="pre">page_start_position</span></code>列の深掘り<a class="headerlink" href="#page-startpage-endpagespage-start-position" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># is_animated別に各指標の平均値を算出</span>
<span class="n">df_ce_ac</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;is_animated&quot;</span><span class="p">)[</span>
    <span class="p">[</span><span class="s2">&quot;page_start&quot;</span><span class="p">,</span> <span class="s2">&quot;page_end&quot;</span><span class="p">,</span> <span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="s2">&quot;page_start_position&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>page_start</th>
      <th>page_end</th>
      <th>pages</th>
      <th>page_start_position</th>
    </tr>
    <tr>
      <th>is_animated</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>False</th>
      <td>217.147238</td>
      <td>234.696809</td>
      <td>18.549570</td>
      <td>0.544581</td>
    </tr>
    <tr>
      <th>True</th>
      <td>186.824017</td>
      <td>204.165529</td>
      <td>18.341513</td>
      <td>0.418081</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ce_acデータフレームでピボットテーブルを作成</span>
<span class="c1"># &#39;is_animated&#39;をインデックスとして、&#39;mcname&#39;を列とし、</span>
<span class="c1"># &#39;page_start_position&#39;の値に基づく平均値を集約関数として計算</span>
<span class="n">df_ce_ac</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="s2">&quot;is_animated&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;mcname&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;page_start_position&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>mcname</th>
      <th>週刊少年サンデー</th>
      <th>週刊少年ジャンプ</th>
      <th>週刊少年チャンピオン</th>
      <th>週刊少年マガジン</th>
    </tr>
    <tr>
      <th>is_animated</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>False</th>
      <td>0.539659</td>
      <td>0.572595</td>
      <td>0.530063</td>
      <td>0.547054</td>
    </tr>
    <tr>
      <th>True</th>
      <td>0.389284</td>
      <td>0.433425</td>
      <td>0.285667</td>
      <td>0.455331</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="two-coloredfour-colored">
<h3><code class="docutils literal notranslate"><span class="pre">two_colored</span></code>、<code class="docutils literal notranslate"><span class="pre">four_colored</span></code>列の深堀り<a class="headerlink" href="#two-coloredfour-colored" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># is_animated別に各指標の平均値を算出</span>
<span class="n">df_ce_ac</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;is_animated&quot;</span><span class="p">)[[</span><span class="s2">&quot;two_colored&quot;</span><span class="p">,</span> <span class="s2">&quot;four_colored&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>two_colored</th>
      <th>four_colored</th>
    </tr>
    <tr>
      <th>is_animated</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>False</th>
      <td>0.044493</td>
      <td>0.065281</td>
    </tr>
    <tr>
      <th>True</th>
      <td>0.019369</td>
      <td>0.093787</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ce_acデータフレームを&#39;ccid&#39;と&#39;ccname&#39;に基づいてグループ化し</span>
<span class="c1"># &#39;two_colored&#39;, &#39;four_colored&#39;, &#39;is_animated&#39;, &#39;n_ce&#39;の各列について平均を計算</span>
<span class="c1"># （&#39;is_animated&#39;と&#39;n_ce&#39;に関してはccid内で同じ値を取るため平均をとっても問題ない）</span>
<span class="n">df_cc_colored</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_ce_ac</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;ccid&quot;</span><span class="p">,</span> <span class="s2">&quot;ccname&quot;</span><span class="p">])[</span>
        <span class="p">[</span><span class="s2">&quot;two_colored&quot;</span><span class="p">,</span> <span class="s2">&quot;four_colored&quot;</span><span class="p">,</span> <span class="s2">&quot;is_animated&quot;</span><span class="p">,</span> <span class="s2">&quot;n_ce&quot;</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="p">)</span>

<span class="c1"># df_cc_coloredデータフレームを&#39;two_colored&#39;列の値で降順に並び替え、上位5行を表示</span>
<span class="n">df_cc_colored</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;two_colored&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ccid</th>
      <th>ccname</th>
      <th>two_colored</th>
      <th>four_colored</th>
      <th>is_animated</th>
      <th>n_ce</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5333</th>
      <td>C93922</td>
      <td>流血鬼</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3079</th>
      <td>C90621</td>
      <td>荒野への帰還</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3945</th>
      <td>C91841</td>
      <td>南野陽子物語</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4633</th>
      <td>C92894</td>
      <td>コンクリート・ライブ</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2006</th>
      <td>C89268</td>
      <td>ニートに翔んで</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># n_ceの最小値を8として設定</span>
<span class="n">min_nce</span> <span class="o">=</span> <span class="mi">8</span>
<span class="c1"># is_animated別に各指標の平均値を算出</span>
<span class="n">df_ce_ac</span><span class="p">[</span><span class="n">df_ce_ac</span><span class="p">[</span><span class="s2">&quot;n_ce&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_nce</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;is_animated&quot;</span><span class="p">)[</span>
    <span class="p">[</span><span class="s2">&quot;two_colored&quot;</span><span class="p">,</span> <span class="s2">&quot;four_colored&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>two_colored</th>
      <th>four_colored</th>
    </tr>
    <tr>
      <th>is_animated</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>False</th>
      <td>0.042763</td>
      <td>0.060272</td>
    </tr>
    <tr>
      <th>True</th>
      <td>0.019365</td>
      <td>0.093882</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 年代別に各指標の平均値を算出して表示</span>
<span class="n">df_ce_ac</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;years&quot;</span><span class="p">)[[</span><span class="s2">&quot;is_animated&quot;</span><span class="p">,</span> <span class="s2">&quot;two_colored&quot;</span><span class="p">,</span> <span class="s2">&quot;four_colored&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_animated</th>
      <th>two_colored</th>
      <th>four_colored</th>
    </tr>
    <tr>
      <th>years</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1970.0</th>
      <td>0.053436</td>
      <td>0.033272</td>
      <td>0.094522</td>
    </tr>
    <tr>
      <th>1975.0</th>
      <td>0.070777</td>
      <td>0.126122</td>
      <td>0.065824</td>
    </tr>
    <tr>
      <th>1980.0</th>
      <td>0.073442</td>
      <td>0.125217</td>
      <td>0.042401</td>
    </tr>
    <tr>
      <th>1985.0</th>
      <td>0.099111</td>
      <td>0.076740</td>
      <td>0.042873</td>
    </tr>
    <tr>
      <th>1990.0</th>
      <td>0.189754</td>
      <td>0.035601</td>
      <td>0.040300</td>
    </tr>
    <tr>
      <th>1995.0</th>
      <td>0.280905</td>
      <td>0.019133</td>
      <td>0.048192</td>
    </tr>
    <tr>
      <th>2000.0</th>
      <td>0.340570</td>
      <td>0.004701</td>
      <td>0.067801</td>
    </tr>
    <tr>
      <th>2005.0</th>
      <td>0.362271</td>
      <td>0.000563</td>
      <td>0.092917</td>
    </tr>
    <tr>
      <th>2010.0</th>
      <td>0.404778</td>
      <td>0.001373</td>
      <td>0.111006</td>
    </tr>
    <tr>
      <th>2015.0</th>
      <td>0.323192</td>
      <td>0.000671</td>
      <td>0.120778</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="n-ce">
<h3><code class="docutils literal notranslate"><span class="pre">n_ce</span></code>列の深掘り<a class="headerlink" href="#n-ce" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_ce_acデータフレームから&#39;ccid&#39;列を基準に重複を削除し、</span>
<span class="c1"># 新しいインデックスを割り当てて新しいデータフレームdf_cc_acを作成</span>
<span class="n">df_cc_ac</span> <span class="o">=</span> <span class="n">df_ce_ac</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ccid&quot;</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># df_cc_acデータフレームを&#39;is_animated&#39;に基づいてグループ化し、</span>
<span class="c1"># &#39;n_ce&#39;の列についての要約統計量を計算</span>
<span class="n">df_cc_ac</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;is_animated&quot;</span><span class="p">)[</span><span class="s2">&quot;n_ce&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>is_animated</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>False</th>
      <td>6796.0</td>
      <td>20.142731</td>
      <td>50.005947</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>16.0</td>
      <td>635.0</td>
    </tr>
    <tr>
      <th>True</th>
      <td>157.0</td>
      <td>275.012739</td>
      <td>225.826516</td>
      <td>1.0</td>
      <td>161.0</td>
      <td>241.0</td>
      <td>337.0</td>
      <td>1968.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="n-2cn-4c">
<h3><code class="docutils literal notranslate"><span class="pre">n_2c</span></code>、<code class="docutils literal notranslate"><span class="pre">n_4c</span></code>列の深堀り<a class="headerlink" href="#n-2cn-4c" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_cc_acデータフレームを&#39;is_animated&#39;に基づいてグループ化し、</span>
<span class="c1"># &#39;n_2c&#39;、&#39;n_4c&#39;の列についての要約統計量を計算して転置表示</span>
<span class="c1"># （df_ce_acではなくdf_cc_acであることに注意！）</span>
<span class="n">df_cc_ac</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;is_animated&quot;</span><span class="p">)[[</span><span class="s2">&quot;n_2c&quot;</span><span class="p">,</span> <span class="s2">&quot;n_4c&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_animated</th>
      <th>False</th>
      <th>True</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="8" valign="top">n_2c</th>
      <th>count</th>
      <td>6796.000000</td>
      <td>157.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.873896</td>
      <td>5.331210</td>
    </tr>
    <tr>
      <th>std</th>
      <td>4.380116</td>
      <td>11.839952</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.000000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>161.000000</td>
      <td>72.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">n_4c</th>
      <th>count</th>
      <td>6796.000000</td>
      <td>157.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.309005</td>
      <td>25.643312</td>
    </tr>
    <tr>
      <th>std</th>
      <td>4.730921</td>
      <td>25.115378</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>9.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>19.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.000000</td>
      <td>35.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>200.000000</td>
      <td>158.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_cc_acのうち、n_acに関して降順ソートし、特定の列について上位5行を表示</span>
<span class="n">df_cc_ac</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;n_2c&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span>
    <span class="p">[</span><span class="s2">&quot;mcname&quot;</span><span class="p">,</span> <span class="s2">&quot;ccname&quot;</span><span class="p">,</span> <span class="s2">&quot;n_ce&quot;</span><span class="p">,</span> <span class="s2">&quot;n_2c&quot;</span><span class="p">,</span> <span class="s2">&quot;n_4c&quot;</span><span class="p">,</span> <span class="s2">&quot;is_animated&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>ccname</th>
      <th>n_ce</th>
      <th>n_2c</th>
      <th>n_4c</th>
      <th>is_animated</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3232</th>
      <td>週刊少年チャンピオン</td>
      <td>がきデカ</td>
      <td>332</td>
      <td>161</td>
      <td>70</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3184</th>
      <td>週刊少年チャンピオン</td>
      <td>ドカベン</td>
      <td>635</td>
      <td>109</td>
      <td>200</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3223</th>
      <td>週刊少年チャンピオン</td>
      <td>らんぽう</td>
      <td>457</td>
      <td>79</td>
      <td>29</td>
      <td>False</td>
    </tr>
    <tr>
      <th>446</th>
      <td>週刊少年マガジン</td>
      <td>釣りキチ三平</td>
      <td>482</td>
      <td>74</td>
      <td>17</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1333</th>
      <td>週刊少年ジャンプ</td>
      <td>キン肉マン</td>
      <td>400</td>
      <td>72</td>
      <td>22</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># grepコマンドで、がきデカを含む文字列をae_dropped.csvから抽出</span>
<span class="o">!</span>grep<span class="w"> </span>がきデカ<span class="w"> </span>../../../data/an/interim/ae_dropped.csv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M23737,,,,C8579,がきデカ,C7146
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="first-date-cclast-date-cc">
<h3><code class="docutils literal notranslate"><span class="pre">first_date_cc</span></code>、<code class="docutils literal notranslate"><span class="pre">last_date_cc</span></code>列の深掘り<a class="headerlink" href="#first-date-cclast-date-cc" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;first_date_cc&#39;列と&#39;last_date_cc&#39;列のデータを日付型に変換</span>
<span class="n">df_cc_ac</span><span class="p">[</span><span class="s2">&quot;first_date_cc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_cc_ac</span><span class="p">[</span><span class="s2">&quot;first_date_cc&quot;</span><span class="p">])</span>
<span class="n">df_cc_ac</span><span class="p">[</span><span class="s2">&quot;last_date_cc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_cc_ac</span><span class="p">[</span><span class="s2">&quot;last_date_cc&quot;</span><span class="p">])</span>

<span class="c1"># &#39;is_animated&#39;でデータをグループ化し、&#39;first_date_cc&#39;（最初の日付）と&#39;last_date_cc&#39;（最後の日付）の</span>
<span class="c1"># 統計的な要約（count, mean, std, min, 25%, 50%, 75%, max）を計算</span>
<span class="c1"># .T（転置）を用いて、結果の表示形式を行と列を入れ替えて、より読みやすく整理</span>
<span class="n">df_cc_ac</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;is_animated&quot;</span><span class="p">)[[</span><span class="s2">&quot;first_date_cc&quot;</span><span class="p">,</span> <span class="s2">&quot;last_date_cc&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_animated</th>
      <th>False</th>
      <th>True</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="7" valign="top">first_date_cc</th>
      <th>count</th>
      <td>6796</td>
      <td>157</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1993-09-05 08:51:37.822248320</td>
      <td>1998-12-17 00:36:41.273885312</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1970-07-27 00:00:00</td>
      <td>1970-08-02 00:00:00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1980-08-24 00:00:00</td>
      <td>1993-06-14 00:00:00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1993-03-28 00:00:00</td>
      <td>2001-06-06 00:00:00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2006-12-14 00:00:00</td>
      <td>2007-08-09 00:00:00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2017-07-31 00:00:00</td>
      <td>2016-05-23 00:00:00</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">last_date_cc</th>
      <th>count</th>
      <td>6796</td>
      <td>157</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1994-04-14 15:13:27.298410880</td>
      <td>2007-03-09 00:09:10.318471424</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1970-07-27 00:00:00</td>
      <td>1971-01-17 00:00:00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1981-01-12 00:00:00</td>
      <td>2002-05-01 00:00:00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1994-01-01 00:00:00</td>
      <td>2009-09-14 00:00:00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2007-11-20 18:00:00</td>
      <td>2016-08-31 00:00:00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2017-07-31 00:00:00</td>
      <td>2017-07-31 00:00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="mcidmcname">
<h3><code class="docutils literal notranslate"><span class="pre">mcid</span></code>、<code class="docutils literal notranslate"><span class="pre">mcname</span></code>列の深掘り<a class="headerlink" href="#mcidmcname" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># アニメ化実績のあるマンガ作品に対して、mcnameごとの各列の平均値を算出</span>
<span class="n">df_cc_ac</span><span class="p">[</span><span class="n">df_cc_ac</span><span class="p">[</span><span class="s2">&quot;is_animated&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;mcname&quot;</span><span class="p">)[[</span><span class="s2">&quot;n_ce&quot;</span><span class="p">,</span> <span class="s2">&quot;n_2c&quot;</span><span class="p">,</span> <span class="s2">&quot;n_4c&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n_ce</th>
      <th>n_2c</th>
      <th>n_4c</th>
    </tr>
    <tr>
      <th>mcname</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>週刊少年サンデー</th>
      <td>276.756757</td>
      <td>3.621622</td>
      <td>20.216216</td>
    </tr>
    <tr>
      <th>週刊少年ジャンプ</th>
      <td>283.859375</td>
      <td>10.265625</td>
      <td>32.296875</td>
    </tr>
    <tr>
      <th>週刊少年チャンピオン</th>
      <td>248.000000</td>
      <td>1.692308</td>
      <td>34.615385</td>
    </tr>
    <tr>
      <th>週刊少年マガジン</th>
      <td>268.511628</td>
      <td>0.558140</td>
      <td>17.697674</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;is_animated&#39;がTrue場合のデータをフィルタリングして、&#39;mcname&#39;でグループ化</span>
<span class="c1"># &#39;n_ce&#39;、&#39;n_2c&#39;、&#39;n_4c&#39;の平均値を計算</span>
<span class="n">df_tmp_animated</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_cc_ac</span><span class="p">[</span><span class="n">df_cc_ac</span><span class="p">[</span><span class="s2">&quot;is_animated&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;mcname&quot;</span><span class="p">)[[</span><span class="s2">&quot;n_ce&quot;</span><span class="p">,</span> <span class="s2">&quot;n_2c&quot;</span><span class="p">,</span> <span class="s2">&quot;n_4c&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="p">)</span>

<span class="c1"># 全コンテンツ（アニメーションの有無に関わらず）を&#39;mcname&#39;でグループ化し、</span>
<span class="c1"># 同じく&#39;n_ce&#39;、&#39;n_2c&#39;、&#39;n_4c&#39;の平均値を計算</span>
<span class="n">df_tmp_all</span> <span class="o">=</span> <span class="n">df_cc_ac</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;mcname&quot;</span><span class="p">)[[</span><span class="s2">&quot;n_ce&quot;</span><span class="p">,</span> <span class="s2">&quot;n_2c&quot;</span><span class="p">,</span> <span class="s2">&quot;n_4c&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># アニメーションがあるコンテンツの平均値を、全コンテンツの平均値で割る</span>
<span class="c1"># これにより、アニメーションがあるコンテンツの特性が全体と比べてどのように異なるかを数値的に把握できる</span>
<span class="n">df_tmp_animated</span> <span class="o">/</span> <span class="n">df_tmp_all</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n_ce</th>
      <th>n_2c</th>
      <th>n_4c</th>
    </tr>
    <tr>
      <th>mcname</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>週刊少年サンデー</th>
      <td>9.024349</td>
      <td>3.094201</td>
      <td>12.190028</td>
    </tr>
    <tr>
      <th>週刊少年ジャンプ</th>
      <td>14.023358</td>
      <td>9.256889</td>
      <td>15.821456</td>
    </tr>
    <tr>
      <th>週刊少年チャンピオン</th>
      <td>9.474022</td>
      <td>2.002622</td>
      <td>17.130076</td>
    </tr>
    <tr>
      <th>週刊少年マガジン</th>
      <td>9.364086</td>
      <td>0.742321</td>
      <td>10.890877</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="id9">
<h3><code class="docutils literal notranslate"><span class="pre">acid</span></code>、<code class="docutils literal notranslate"><span class="pre">acname</span></code>列の深掘り<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;ccname_closest&#39;列を作成し、各行に対して&#39;find_closest_match&#39;関数を適用</span>
<span class="c1"># この関数は、現在の行のデータに基づいてdf_cc_acデータフレーム内の最も近いマッチを見つける</span>
<span class="c1"># applyメソッドを用いて行ごとに処理を適用する（引数としてdf_cc_acを渡す）</span>
<span class="n">df_cc_ac</span><span class="p">[</span><span class="s2">&quot;ccname_closest&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_cc_ac</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">find_closest_match</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df_cc_ac</span><span class="p">)</span>

<span class="c1"># アニメーションがあるコンテンツ（&#39;is_animated&#39;がTrue）のみをフィルタリングし、特定の列を抽出</span>
<span class="c1"># reset_index(drop=True)でインデックスをリセットし、新しい連番のインデックスを作成することで、</span>
<span class="c1"># 選択したデータを新しいデータフレームdf_tmpとして整理</span>
<span class="n">df_tmp</span> <span class="o">=</span> <span class="n">df_cc_ac</span><span class="p">[</span><span class="n">df_cc_ac</span><span class="p">[</span><span class="s2">&quot;is_animated&quot;</span><span class="p">]][</span>
    <span class="p">[</span><span class="s2">&quot;acname&quot;</span><span class="p">,</span> <span class="s2">&quot;ccname&quot;</span><span class="p">,</span> <span class="s2">&quot;ccname_closest&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ccname（原作マンガ作品名の正解）とccname_closest（acnameと最も近いccname）が</span>
<span class="c1"># 一致している割合を算出</span>
<span class="p">(</span><span class="n">df_tmp</span><span class="p">[</span><span class="s2">&quot;ccname&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df_tmp</span><span class="p">[</span><span class="s2">&quot;ccname_closest&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8343949044585988
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ccnameとccname_closestが一致しない作品リスト</span>
<span class="n">df_tmp</span><span class="p">[</span><span class="n">df_tmp</span><span class="p">[</span><span class="s2">&quot;ccname&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">df_tmp</span><span class="p">[</span><span class="s2">&quot;ccname_closest&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acname</th>
      <th>ccname</th>
      <th>ccname_closest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>CØDE: BREAKER</td>
      <td>CODE:BREAKER コード:ブレイカー</td>
      <td>SWORD BREAKER</td>
    </tr>
    <tr>
      <th>7</th>
      <td>はじめの 一歩 THE FIGHTING!</td>
      <td>はじめの一歩</td>
      <td>IN THE TRAIN</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ツバサ・クロニクル　年代記[第1期]</td>
      <td>ツバサ ～RESERVoir CHRoNiCLE～</td>
      <td>バイオハザード アンブレラ・クロニクルズ 崩壊への序曲</td>
    </tr>
    <tr>
      <th>17</th>
      <td>School Rumble</td>
      <td>スクールランブル</td>
      <td>Moon Walker</td>
    </tr>
    <tr>
      <th>22</th>
      <td>ゲットバッカーズ 奪還屋</td>
      <td>Get Backers 奪還屋</td>
      <td>ロボットボーイズ</td>
    </tr>
    <tr>
      <th>25</th>
      <td>RAVE GROOVE ADVENTURE</td>
      <td>RAVE</td>
      <td>SPACE ADVENTURE コブラ</td>
    </tr>
    <tr>
      <th>28</th>
      <td>アソボット戦記 五九</td>
      <td>アソボット五九</td>
      <td>アソボット戦記五九</td>
    </tr>
    <tr>
      <th>36</th>
      <td>巨人の星 【特別篇】 猛虎 花形満 ～『巨人の星』全182話より特別編集～</td>
      <td>巨人の星</td>
      <td>巨人の星外伝それからの飛雄馬</td>
    </tr>
    <tr>
      <th>40</th>
      <td>ドクタースランプ</td>
      <td>Dr.スランプ</td>
      <td>ドクター・ジュン</td>
    </tr>
    <tr>
      <th>54</th>
      <td>ハンター×ハンター</td>
      <td>HUNTER×HUNTER</td>
      <td>ハングリーハート</td>
    </tr>
    <tr>
      <th>71</th>
      <td>-仙界伝- 封神 演義</td>
      <td>封神演義</td>
      <td>異説 封神演義</td>
    </tr>
    <tr>
      <th>82</th>
      <td>DRAGON BALL KAI</td>
      <td>DRAGON　BALL</td>
      <td>DRAGON BALL 外伝</td>
    </tr>
    <tr>
      <th>87</th>
      <td>シティーハンター3</td>
      <td>CITY HUNTER シティ・ハンター</td>
      <td>モンスターハンター</td>
    </tr>
    <tr>
      <th>90</th>
      <td>COBRA THE ANIMATION</td>
      <td>SPACE ADVENTURE コブラ</td>
      <td>鉄のラインバレル THE ANIMATION</td>
    </tr>
    <tr>
      <th>94</th>
      <td>侵略! イカ娘 The invader comes from the bottom of t...</td>
      <td>侵略!イカ娘</td>
      <td>Magazine Heroines on the Beach!!</td>
    </tr>
    <tr>
      <th>112</th>
      <td>ムシブギョー 蟲奉行</td>
      <td>常住戦陣!!ムシブギョー</td>
      <td>ムシブギョー 蟲奉行</td>
    </tr>
    <tr>
      <th>121</th>
      <td>まじっく快斗 KID THE PHANTOM THIEF 第1話 「蘇る怪盗」</td>
      <td>まじっく快斗</td>
      <td>DEATH NOTE</td>
    </tr>
    <tr>
      <th>123</th>
      <td>MÄR メルヘヴン MÄRCHEN AWAKENS ROMANCE</td>
      <td>MAR メル</td>
      <td>AL  THE WHITE TRICERATOPS</td>
    </tr>
    <tr>
      <th>128</th>
      <td>PROJECT ARMS</td>
      <td>ARMS</td>
      <td>GOLEM HEARTS</td>
    </tr>
    <tr>
      <th>130</th>
      <td>メジャー</td>
      <td>MAJOR</td>
      <td>銀輪ジャガー</td>
    </tr>
    <tr>
      <th>131</th>
      <td>ガンバリスト!駿</td>
      <td>ガンバ!!Fly high</td>
      <td>俺はガメリスト</td>
    </tr>
    <tr>
      <th>133</th>
      <td>GS美神</td>
      <td>ゴーストスイーパー美神 極楽大作戦!!</td>
      <td>荒神</td>
    </tr>
    <tr>
      <th>138</th>
      <td>人造人間 キカイダー THE ANIMATION</td>
      <td>人造人間キカイダー</td>
      <td>鉄のラインバレル THE ANIMATION</td>
    </tr>
    <tr>
      <th>145</th>
      <td>七つの大罪 The Seven Deadly Sins</td>
      <td>七つの大罪</td>
      <td>MMR  The Apocalypse</td>
    </tr>
    <tr>
      <th>149</th>
      <td>金田一少年の 事件簿Ｒ[リターンズ]</td>
      <td>金田一少年の事件簿R</td>
      <td>金田一少年の事件簿</td>
    </tr>
    <tr>
      <th>151</th>
      <td>電波教師 HE IS AN ULTIMATE TEACHER</td>
      <td>電波教師</td>
      <td>ULTIMATE CHASER</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ccnameに「アソボット」を含むデータを抽出し、特定の列を表示しつつ、dateで昇順ソート</span>
<span class="n">df_ce_ac</span><span class="p">[</span><span class="n">df_ce_ac</span><span class="p">[</span><span class="s2">&quot;ccname&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;アソボット&quot;</span><span class="p">)][</span>
    <span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;ccname&quot;</span><span class="p">,</span> <span class="s2">&quot;cename&quot;</span><span class="p">,</span> <span class="s2">&quot;acname&quot;</span><span class="p">,</span> <span class="s2">&quot;first_date_ac&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>ccname</th>
      <th>cename</th>
      <th>acname</th>
      <th>first_date_ac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>18384</th>
      <td>2002-01-17</td>
      <td>アソボット五九</td>
      <td>第1話 大悪党・五九 参上!!</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18383</th>
      <td>2002-01-23</td>
      <td>アソボット五九</td>
      <td>第2話 ハーモニカを持った少年</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18382</th>
      <td>2002-01-30</td>
      <td>アソボット五九</td>
      <td>第3話 ゴータ・マ村長の決意</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18381</th>
      <td>2002-02-06</td>
      <td>アソボット五九</td>
      <td>第4話 サルってゆうんじゃねえ!</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18380</th>
      <td>2002-02-13</td>
      <td>アソボット五九</td>
      <td>第5話 脅威!マリオネットシール</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18379</th>
      <td>2002-02-20</td>
      <td>アソボット五九</td>
      <td>第6話 ナミダの温度</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18378</th>
      <td>2002-02-27</td>
      <td>アソボット五九</td>
      <td>第7話 はるかなる旅路へ</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18377</th>
      <td>2002-03-06</td>
      <td>アソボット五九</td>
      <td>第8話 美少女盗賊・魅音サマ</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18376</th>
      <td>2002-03-13</td>
      <td>アソボット五九</td>
      <td>第9話 白い砂漠</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18375</th>
      <td>2002-03-20</td>
      <td>アソボット五九</td>
      <td>第10話 強敵・ヤズー現る!</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18374</th>
      <td>2002-03-27</td>
      <td>アソボット五九</td>
      <td>第11幕 テルミニ村と大蛇神</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18373</th>
      <td>2002-04-03</td>
      <td>アソボット五九</td>
      <td>第12話 アップデート大作戦</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18372</th>
      <td>2002-04-10</td>
      <td>アソボット五九</td>
      <td>第13話 速攻!敵アジト潜入</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18371</th>
      <td>2002-04-17</td>
      <td>アソボット五九</td>
      <td>第14話 悪魔のウイルス</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18370</th>
      <td>2002-04-24</td>
      <td>アソボット五九</td>
      <td>第15話 再戦!五九vsヤズー</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18369</th>
      <td>2002-05-01</td>
      <td>アソボット五九</td>
      <td>第16話 決着!</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18368</th>
      <td>2002-05-08</td>
      <td>アソボット五九</td>
      <td>第17話 蛇神祭</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18367</th>
      <td>2002-05-15</td>
      <td>アソボット五九</td>
      <td>第18話 謎、深まる</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18366</th>
      <td>2002-06-05</td>
      <td>アソボット五九</td>
      <td>特別編 sanzo@rei 第2話 ふたり暮らし</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18365</th>
      <td>2002-06-05</td>
      <td>アソボット五九</td>
      <td>特別編 sanzo@rei 第1話 プロトタイプ・レイ</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18364</th>
      <td>2002-06-12</td>
      <td>アソボット五九</td>
      <td>特別編 sanzo@rei 第3話 ワカラナイ</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18363</th>
      <td>2002-06-19</td>
      <td>アソボット五九</td>
      <td>特別編 sanzo@rei 第4話 「恋」をするということ</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18362</th>
      <td>2002-06-26</td>
      <td>アソボット五九</td>
      <td>特別編 sanzo@rei 第5話 evolution</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18361</th>
      <td>2002-07-03</td>
      <td>アソボット五九</td>
      <td>特別編 sanzo@rei 第6話 破局の予感</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18360</th>
      <td>2002-07-10</td>
      <td>アソボット五九</td>
      <td>特別編 sanzo@rei 第7話 アダムとイブ</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18359</th>
      <td>2002-07-17</td>
      <td>アソボット五九</td>
      <td>特別編 sanzo@rei 第8話 最後のナミダ</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18358</th>
      <td>2002-07-24</td>
      <td>アソボット五九</td>
      <td>特別編 sanzo@rei 第9話 ココロ…終わることなく紡がれて</td>
      <td>アソボット戦記 五九</td>
      <td>2002-10-01</td>
    </tr>
    <tr>
      <th>18000</th>
      <td>2002-10-09</td>
      <td>アソボット戦記五九</td>
      <td>前編 五九一家登場!</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17999</th>
      <td>2002-10-16</td>
      <td>アソボット戦記五九</td>
      <td>後編</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="id10">
<h3><code class="docutils literal notranslate"><span class="pre">asid</span></code>列の深堀り<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># asidでグループ化し、mcname、ccname、ccidに関しては先頭のものを抽出</span>
<span class="c1"># ceidに関してはユニーク数を集計</span>
<span class="n">df_tmp</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_ce_ac</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;asid&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;mcname&quot;</span><span class="p">:</span> <span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;ccname&quot;</span><span class="p">:</span> <span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;ccid&quot;</span><span class="p">:</span> <span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;ceid&quot;</span><span class="p">:</span> <span class="s2">&quot;nunique&quot;</span><span class="p">})</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="p">)</span>
<span class="c1"># ceidのユニーク数（つまり合計各話数）の要約統計量を算出</span>
<span class="n">df_tmp</span><span class="p">[</span><span class="s2">&quot;ceid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>ceid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>count</td>
      <td>152.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mean</td>
      <td>286.342105</td>
    </tr>
    <tr>
      <th>2</th>
      <td>std</td>
      <td>229.496717</td>
    </tr>
    <tr>
      <th>3</th>
      <td>min</td>
      <td>16.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25%</td>
      <td>166.250000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>50%</td>
      <td>244.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>75%</td>
      <td>341.250000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max</td>
      <td>1968.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 合計各話数に関して昇順ソートし、上位5行を表示</span>
<span class="n">df_tmp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;ceid&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>asid</th>
      <th>mcname</th>
      <th>ccname</th>
      <th>ccid</th>
      <th>ceid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>111</th>
      <td>C4571</td>
      <td>週刊少年ジャンプ</td>
      <td>レベルE</td>
      <td>C89851</td>
      <td>16</td>
    </tr>
    <tr>
      <th>53</th>
      <td>C2640</td>
      <td>週刊少年マガジン</td>
      <td>アソボット五九</td>
      <td>C90306</td>
      <td>27</td>
    </tr>
    <tr>
      <th>22</th>
      <td>C1994</td>
      <td>週刊少年マガジン</td>
      <td>中華一番!</td>
      <td>C90794</td>
      <td>30</td>
    </tr>
    <tr>
      <th>33</th>
      <td>C2285</td>
      <td>週刊少年ジャンプ</td>
      <td>人形草子あやつり左近</td>
      <td>C88332</td>
      <td>32</td>
    </tr>
    <tr>
      <th>89</th>
      <td>C3508</td>
      <td>週刊少年ジャンプ</td>
      <td>初恋限定。</td>
      <td>C89375</td>
      <td>32</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="id11">
<h3><code class="docutils literal notranslate"><span class="pre">n_ae</span></code>列の深掘り<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># n_aeに関して降順ソートしたうえで特定の列のみ選択し、上位5行を表示</span>
<span class="n">df_cc_ac</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;n_ae&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span>
    <span class="p">[</span><span class="s2">&quot;mcname&quot;</span><span class="p">,</span> <span class="s2">&quot;ccname&quot;</span><span class="p">,</span> <span class="s2">&quot;acname&quot;</span><span class="p">,</span> <span class="s2">&quot;n_ae&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>ccname</th>
      <th>acname</th>
      <th>n_ae</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1347</th>
      <td>週刊少年ジャンプ</td>
      <td>ONE PIECE</td>
      <td>ONE PIECE</td>
      <td>783.0</td>
    </tr>
    <tr>
      <th>4540</th>
      <td>週刊少年サンデー</td>
      <td>名探偵コナン</td>
      <td>名探偵コナン</td>
      <td>729.0</td>
    </tr>
    <tr>
      <th>1359</th>
      <td>週刊少年ジャンプ</td>
      <td>BLEACH</td>
      <td>BLEACH</td>
      <td>369.0</td>
    </tr>
    <tr>
      <th>1349</th>
      <td>週刊少年ジャンプ</td>
      <td>NARUTO-ナルト-</td>
      <td>NARUTO</td>
      <td>221.0</td>
    </tr>
    <tr>
      <th>1352</th>
      <td>週刊少年ジャンプ</td>
      <td>銀魂</td>
      <td>銀魂</td>
      <td>201.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="first-date-aclast-date-ac">
<h3><code class="docutils literal notranslate"><span class="pre">first_date_ac</span></code>、<code class="docutils literal notranslate"><span class="pre">last_date_ac</span></code>列の深掘り<a class="headerlink" href="#first-date-aclast-date-ac" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first_date_acに関して昇順ソートしたうえで特定の列のみ選択し、上位5行を表示</span>
<span class="n">df_cc_ac</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;first_date_ac&quot;</span><span class="p">)[</span>
    <span class="p">[</span><span class="s2">&quot;mcname&quot;</span><span class="p">,</span> <span class="s2">&quot;ccname&quot;</span><span class="p">,</span> <span class="s2">&quot;acname&quot;</span><span class="p">,</span> <span class="s2">&quot;first_date_ac&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mcname</th>
      <th>ccname</th>
      <th>acname</th>
      <th>first_date_ac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2225</th>
      <td>週刊少年ジャンプ</td>
      <td>CITY HUNTER シティ・ハンター</td>
      <td>シティーハンター3</td>
      <td>1990-01-14</td>
    </tr>
    <tr>
      <th>2184</th>
      <td>週刊少年ジャンプ</td>
      <td>まじかる☆タルるートくん</td>
      <td>まじかる★タルるートくん</td>
      <td>1990-09-02</td>
    </tr>
    <tr>
      <th>448</th>
      <td>週刊少年マガジン</td>
      <td>三つ目がとおる</td>
      <td>三つ目がとおる</td>
      <td>1990-10-18</td>
    </tr>
    <tr>
      <th>5407</th>
      <td>週刊少年サンデー</td>
      <td>おれは直角</td>
      <td>おれは直角</td>
      <td>1991-01-05</td>
    </tr>
    <tr>
      <th>1333</th>
      <td>週刊少年ジャンプ</td>
      <td>キン肉マン</td>
      <td>キン肉マン キン肉星王位争奪編</td>
      <td>1991-10-06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># acnameにシティーを含む行に対して、acnameの値の数を集計し、reset_indexでDataFrame化</span>
<span class="n">df_ce_ac</span><span class="p">[</span><span class="n">df_ce_ac</span><span class="p">[</span><span class="s2">&quot;acname&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;シティー&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">][</span>
    <span class="s2">&quot;acname&quot;</span>
<span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acname</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>シティーハンター3</td>
      <td>337</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./vol2/05"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="mix_preprocess.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">メディア展開データの前処理</p>
      </div>
    </a>
    <a class="right-next"
       href="practice_q.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">【練習問題】</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">準備</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import">Import</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">変数</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">関数</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mix-ae-crt-csv"><code class="docutils literal notranslate"><span class="pre">mix_ae_crt.csv</span></code>の基礎分析</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">全体像の把握</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#date"><code class="docutils literal notranslate"><span class="pre">date</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aeidaenameaeno"><code class="docutils literal notranslate"><span class="pre">aeid</span></code>、<code class="docutils literal notranslate"><span class="pre">aename</span></code>、<code class="docutils literal notranslate"><span class="pre">aeno</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acidacname"><code class="docutils literal notranslate"><span class="pre">acid</span></code>、<code class="docutils literal notranslate"><span class="pre">acname</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#asid"><code class="docutils literal notranslate"><span class="pre">asid</span></code>列の深堀り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#n-ae"><code class="docutils literal notranslate"><span class="pre">n_ae</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#first-datelast-date"><code class="docutils literal notranslate"><span class="pre">first_date</span></code>、<code class="docutils literal notranslate"><span class="pre">last_date</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ccidccname"><code class="docutils literal notranslate"><span class="pre">ccid</span></code>、<code class="docutils literal notranslate"><span class="pre">ccname</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mcname"><code class="docutils literal notranslate"><span class="pre">mcname</span></code>列の深堀り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#crtidcrtname"><code class="docutils literal notranslate"><span class="pre">crtid</span></code>、<code class="docutils literal notranslate"><span class="pre">crtname</span></code>列の深掘り</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mix-ce-ac-csv"><code class="docutils literal notranslate"><span class="pre">mix_ce_ac.csv</span></code>の基礎分析</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">全体像の把握</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><code class="docutils literal notranslate"><span class="pre">date</span></code>列の深堀り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ceidcename"><code class="docutils literal notranslate"><span class="pre">ceid</span></code>、<code class="docutils literal notranslate"><span class="pre">cename</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><code class="docutils literal notranslate"><span class="pre">ccid</span></code>、<code class="docutils literal notranslate"><span class="pre">ccname</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#miid"><code class="docutils literal notranslate"><span class="pre">miid</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#page-startpage-endpagespage-start-position"><code class="docutils literal notranslate"><span class="pre">page_start</span></code>、<code class="docutils literal notranslate"><span class="pre">page_end</span></code>、<code class="docutils literal notranslate"><span class="pre">pages</span></code>、<code class="docutils literal notranslate"><span class="pre">page_start_position</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-coloredfour-colored"><code class="docutils literal notranslate"><span class="pre">two_colored</span></code>、<code class="docutils literal notranslate"><span class="pre">four_colored</span></code>列の深堀り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#n-ce"><code class="docutils literal notranslate"><span class="pre">n_ce</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#n-2cn-4c"><code class="docutils literal notranslate"><span class="pre">n_2c</span></code>、<code class="docutils literal notranslate"><span class="pre">n_4c</span></code>列の深堀り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#first-date-cclast-date-cc"><code class="docutils literal notranslate"><span class="pre">first_date_cc</span></code>、<code class="docutils literal notranslate"><span class="pre">last_date_cc</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mcidmcname"><code class="docutils literal notranslate"><span class="pre">mcid</span></code>、<code class="docutils literal notranslate"><span class="pre">mcname</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><code class="docutils literal notranslate"><span class="pre">acid</span></code>、<code class="docutils literal notranslate"><span class="pre">acname</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><code class="docutils literal notranslate"><span class="pre">asid</span></code>列の深堀り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><code class="docutils literal notranslate"><span class="pre">n_ae</span></code>列の深掘り</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#first-date-aclast-date-ac"><code class="docutils literal notranslate"><span class="pre">first_date_ac</span></code>、<code class="docutils literal notranslate"><span class="pre">last_date_ac</span></code>列の深掘り</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  © Copyright 2026 by <a rel="kakeami" href="https://github.com/kakeami"> Kakeami </a>. この作品は<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">クリエイティブ・コモンズ 表示 - 非営利 - 改変禁止 4.0 国際 ライセンス</a>の下に提供されています． <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="クリエイティブ・コモンズ・ライセンス" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/80x15.png" /></a>　ただし，作品中のコードセル部分は<a rel="license" href="https://opensource.org/licenses/MIT">MITライセンス</a>の下に提供されています．

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>